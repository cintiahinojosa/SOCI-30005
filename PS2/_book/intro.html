<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>2 Intro | A Minimal Book Example</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="2 Intro | A Minimal Book Example" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Intro | A Minimal Book Example" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Yihui Xie">


<meta name="date" content="2019-04-29">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="index.html">
<link rel="next" href="naive-model.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>
<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<script src="libs/datatables-binding-0.2/datatables.js"></script>
<link href="libs/dt-core-1.10.12/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.12/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.12/js/jquery.dataTables.min.js"></script>
<script src="libs/jszip-1.10.12/jszip.min.js"></script>
<script src="libs/pdfmake-1.10.12/pdfmake.min.js"></script>
<script src="libs/pdfmake-1.10.12/vfs_fonts.js"></script>
<link href="libs/dt-ext-buttons-1.10.12/css/buttons.dataTables.min.css" rel="stylesheet" />
<script src="libs/dt-ext-buttons-1.10.12/js/dataTables.buttons.min.js"></script>
<script src="libs/dt-ext-buttons-1.10.12/js/buttons.flash.min.js"></script>
<script src="libs/dt-ext-buttons-1.10.12/js/buttons.html5.min.js"></script>
<script src="libs/dt-ext-buttons-1.10.12/js/buttons.colVis.min.js"></script>
<script src="libs/dt-ext-buttons-1.10.12/js/buttons.print.min.js"></script>
<link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet" />
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet" />
<script src="libs/selectize-0.12.0/selectize.min.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Intro</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#csiw-dataset"><i class="fa fa-check"></i><b>2.1</b> CSIW Dataset</a><ul>
<li class="chapter" data-level="2.1.1" data-path="intro.html"><a href="intro.html#metadata"><i class="fa fa-check"></i><b>2.1.1</b> Metadata</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#variables"><i class="fa fa-check"></i><b>2.2</b> Variables</a><ul>
<li class="chapter" data-level="2.2.1" data-path="intro.html"><a href="intro.html#school"><i class="fa fa-check"></i><b>2.2.1</b> school</a></li>
<li class="chapter" data-level="2.2.2" data-path="intro.html"><a href="intro.html#teacher"><i class="fa fa-check"></i><b>2.2.2</b> teacher</a></li>
<li class="chapter" data-level="2.2.3" data-path="intro.html"><a href="intro.html#id"><i class="fa fa-check"></i><b>2.2.3</b> id</a></li>
<li class="chapter" data-level="2.2.4" data-path="intro.html"><a href="intro.html#group"><i class="fa fa-check"></i><b>2.2.4</b> group</a></li>
<li class="chapter" data-level="2.2.5" data-path="intro.html"><a href="intro.html#treatmt"><i class="fa fa-check"></i><b>2.2.5</b> treatmt</a></li>
<li class="chapter" data-level="2.2.6" data-path="intro.html"><a href="intro.html#cch1"><i class="fa fa-check"></i><b>2.2.6</b> cch1</a></li>
<li class="chapter" data-level="2.2.7" data-path="intro.html"><a href="intro.html#cch2"><i class="fa fa-check"></i><b>2.2.7</b> cch2</a></li>
<li class="chapter" data-level="2.2.8" data-path="intro.html"><a href="intro.html#pre_test"><i class="fa fa-check"></i><b>2.2.8</b> pre_test</a></li>
<li class="chapter" data-level="2.2.9" data-path="intro.html"><a href="intro.html#post_test"><i class="fa fa-check"></i><b>2.2.9</b> post_test</a></li>
<li class="chapter" data-level="2.2.10" data-path="intro.html"><a href="intro.html#ccprod1"><i class="fa fa-check"></i><b>2.2.10</b> ccprod1</a></li>
<li class="chapter" data-level="2.2.11" data-path="intro.html"><a href="intro.html#ccprod2"><i class="fa fa-check"></i><b>2.2.11</b> ccprod2</a></li>
<li class="chapter" data-level="2.2.12" data-path="intro.html"><a href="intro.html#ccrdr1"><i class="fa fa-check"></i><b>2.2.12</b> ccrdr1</a></li>
<li class="chapter" data-level="2.2.13" data-path="intro.html"><a href="intro.html#ccrdr2"><i class="fa fa-check"></i><b>2.2.13</b> ccrdr2</a></li>
<li class="chapter" data-level="2.2.14" data-path="intro.html"><a href="intro.html#grade"><i class="fa fa-check"></i><b>2.2.14</b> grade</a></li>
<li class="chapter" data-level="2.2.15" data-path="intro.html"><a href="intro.html#CSIW"><i class="fa fa-check"></i><b>2.2.15</b> CSIW</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#missingness-report"><i class="fa fa-check"></i><b>2.3</b> Missingness report</a></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#codebook-table"><i class="fa fa-check"></i><b>2.4</b> Codebook table</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="naive-model.html"><a href="naive-model.html"><i class="fa fa-check"></i><b>3</b> Naive Model</a></li>
<li class="chapter" data-level="4" data-path="ancova-model.html"><a href="ancova-model.html"><i class="fa fa-check"></i><b>4</b> ANCOVA Model</a></li>
<li class="chapter" data-level="5" data-path="assessing-linearity.html"><a href="assessing-linearity.html"><i class="fa fa-check"></i><b>5</b> Assessing Linearity</a></li>
<li class="chapter" data-level="6" data-path="quadratic-model.html"><a href="quadratic-model.html"><i class="fa fa-check"></i><b>6</b> Quadratic Model</a></li>
<li class="chapter" data-level="7" data-path="searching-for-confounders.html"><a href="searching-for-confounders.html"><i class="fa fa-check"></i><b>7</b> Searching for Confounders</a></li>
<li class="chapter" data-level="8" data-path="heterogeneity.html"><a href="heterogeneity.html"><i class="fa fa-check"></i><b>8</b> Heterogeneity</a></li>
<li class="chapter" data-level="9" data-path="checking-assumptions.html"><a href="checking-assumptions.html"><i class="fa fa-check"></i><b>9</b> Checking Assumptions</a></li>
<li class="chapter" data-level="10" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>10</b> Conclusion</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Minimal Book Example</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="intro" class="section level1">
<h1><span class="header-section-number">2</span> Intro</h1>
<pre class="sourceCode r"><code class="sourceCode r">csiw &lt;-<span class="st"> </span><span class="kw">read_sav</span>(<span class="st">&quot;csiw_new.sav&quot;</span>)
<span class="kw">names</span>(csiw)</code></pre>
<pre><code>##  [1] &quot;school&quot;    &quot;teacher&quot;   &quot;id&quot;        &quot;group&quot;     &quot;treatmt&quot;  
##  [6] &quot;cch1&quot;      &quot;cch2&quot;      &quot;pre_test&quot;  &quot;post_test&quot; &quot;ccprod1&quot;  
## [11] &quot;ccprod2&quot;   &quot;ccrdr1&quot;    &quot;ccrdr2&quot;    &quot;grade&quot;     &quot;CSIW&quot;</code></pre>
<div id="csiw-dataset" class="section level2">
<h2><span class="header-section-number">2.1</span> CSIW Dataset</h2>
<ul>
<li>CSIW (treatmt)
<ul>
<li>1=CSIW</li>
<li>0=control</li>
</ul></li>
<li>Achievement Level ()
<ul>
<li>1=High</li>
<li>2=Average</li>
<li>3=Low</li>
<li>4=Learning Disability</li>
</ul></li>
<li>Holistic pretest
<ul>
<li>pre-test on writing achievement</li>
</ul></li>
<li>Holistic posttest ()
<ul>
<li>post-test on writing achievement</li>
</ul></li>
<li>Grade (grade)
<ul>
<li>1=Grade 4</li>
<li>2=Grade 5</li>
</ul></li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(csiw)</code></pre>
<pre><code>##  [1] &quot;school&quot;    &quot;teacher&quot;   &quot;id&quot;        &quot;group&quot;     &quot;treatmt&quot;  
##  [6] &quot;cch1&quot;      &quot;cch2&quot;      &quot;pre_test&quot;  &quot;post_test&quot; &quot;ccprod1&quot;  
## [11] &quot;ccprod2&quot;   &quot;ccrdr1&quot;    &quot;ccrdr2&quot;    &quot;grade&quot;     &quot;CSIW&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(csiw)</code></pre>
<pre><code>##      school          teacher            id            group      
##  Min.   : 1.000   Min.   : 1.00   Min.   : 1.00   Min.   :1.000  
##  1st Qu.: 1.000   1st Qu.: 4.00   1st Qu.:20.00   1st Qu.:2.000  
##  Median : 2.000   Median : 8.00   Median :35.00   Median :3.000  
##  Mean   : 4.509   Mean   :10.91   Mean   :32.12   Mean   :2.659  
##  3rd Qu.: 9.000   3rd Qu.:18.00   3rd Qu.:44.00   3rd Qu.:4.000  
##  Max.   :13.000   Max.   :55.00   Max.   :61.00   Max.   :4.000  
##                                                   NA&#39;s   :40     
##     treatmt           cch1            cch2         pre_test     
##  Min.   :1.000   Min.   :0.000   Min.   :0.00   Min.   : 0.000  
##  1st Qu.:1.000   1st Qu.:1.000   1st Qu.:1.00   1st Qu.: 4.000  
##  Median :1.000   Median :1.000   Median :2.00   Median : 6.000  
##  Mean   :1.302   Mean   :1.137   Mean   :1.66   Mean   : 6.015  
##  3rd Qu.:2.000   3rd Qu.:2.000   3rd Qu.:2.00   3rd Qu.: 9.000  
##  Max.   :2.000   Max.   :3.000   Max.   :3.00   Max.   :16.000  
##                  NA&#39;s   :79      NA&#39;s   :81     NA&#39;s   :79      
##    post_test         ccprod1          ccprod2           ccrdr1      
##  Min.   : 0.000   Min.   : 0.000   Min.   : 0.000   Min.   :0.0000  
##  1st Qu.: 6.000   1st Qu.: 2.000   1st Qu.: 3.000   1st Qu.:0.0000  
##  Median : 9.000   Median : 4.000   Median : 5.000   Median :0.0000  
##  Mean   : 8.601   Mean   : 3.918   Mean   : 4.911   Mean   :0.8628  
##  3rd Qu.:11.000   3rd Qu.: 6.000   3rd Qu.: 7.000   3rd Qu.:1.0000  
##  Max.   :15.000   Max.   :17.000   Max.   :19.000   Max.   :8.0000  
##  NA&#39;s   :81       NA&#39;s   :79       NA&#39;s   :81       NA&#39;s   :79      
##      ccrdr2           grade            CSIW       
##  Min.   : 0.000   Min.   :1.000   Min.   :0.0000  
##  1st Qu.: 0.000   1st Qu.:1.000   1st Qu.:0.0000  
##  Median : 1.000   Median :1.000   Median :1.0000  
##  Mean   : 2.477   Mean   :1.471   Mean   :0.6978  
##  3rd Qu.: 3.000   3rd Qu.:2.000   3rd Qu.:1.0000  
##  Max.   :12.000   Max.   :2.000   Max.   :1.0000  
##  NA&#39;s   :82       NA&#39;s   :40</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">codebook</span>(csiw)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span><span class="kw">asis_output</span>(data_info)</code></pre>
<div id="metadata" class="section level3">
<h3><span class="header-section-number">2.1.1</span> Metadata</h3>
<div id="description" class="section level4">
<h4><span class="header-section-number">2.1.1.1</span> Description</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="kw">exists</span>(<span class="st">&quot;name&quot;</span>, meta)) {
  glue<span class="op">::</span><span class="kw">glue</span>(
    <span class="st">&quot;__Dataset name__: {name}&quot;</span>,
    <span class="dt">.envir =</span> meta)
}</code></pre>
<p><strong>Dataset name</strong>: csiw</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cat</span>(description)</code></pre>
<p>The dataset has N=407 rows and 15 columns.
258 rows have no missing values on any column.</p>
<details>
<p><summary title="Expand this section to see some additional metadata in a structured format that is useful for search engines">Metadata for search engines</summary></p>
<ul>
<li><strong>Date published</strong>: 2019-04-29</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">meta &lt;-<span class="st"> </span>meta[<span class="kw">setdiff</span>(<span class="kw">names</span>(meta),
                     <span class="kw">c</span>(<span class="st">&quot;creator&quot;</span>, <span class="st">&quot;datePublished&quot;</span>, <span class="st">&quot;identifier&quot;</span>,
                       <span class="st">&quot;url&quot;</span>, <span class="st">&quot;citation&quot;</span>, <span class="st">&quot;spatialCoverage&quot;</span>, 
                       <span class="st">&quot;temporalCoverage&quot;</span>, <span class="st">&quot;description&quot;</span>, <span class="st">&quot;name&quot;</span>))]
pander<span class="op">::</span><span class="kw">pander</span>(meta)</code></pre>
<ul>
<li><strong>keywords</strong>: <em>school</em>, <em>teacher</em>, <em>id</em>, <em>group</em>, <em>treatmt</em>, <em>cch1</em>, <em>cch2</em>, <em>pre_test</em>, <em>post_test</em>, <em>ccprod1</em>, <em>ccprod2</em>, <em>ccrdr1</em>, <em>ccrdr2</em>, <em>grade</em> and <em>CSIW</em></li>
</ul>
<!-- end of list -->
</details>
<pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span><span class="kw">asis_output</span>(survey_overview)</code></pre>
</div>
</div>
</div>
<div id="variables" class="section level2">
<h2><span class="header-section-number">2.2</span> Variables</h2>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (detailed_variables <span class="op">||</span><span class="st"> </span>detailed_scales) {
  knitr<span class="op">::</span><span class="kw">asis_output</span>(<span class="kw">paste0</span>(scales_items, <span class="dt">sep =</span> <span class="st">&quot;</span><span class="ch">\n\n\n</span><span class="st">&quot;</span>, <span class="dt">collapse =</span> <span class="st">&quot;</span><span class="ch">\n\n\n</span><span class="st">&quot;</span>))
}</code></pre>
<div id="school" class="section level3 tabset">
<h3><span class="header-section-number">2.2.1</span> school</h3>
<p>school id</p>
<div id="school_distribution" class="section level4">
<h4><span class="header-section-number">2.2.1.1</span> Distribution</h4>
<pre class="sourceCode r"><code class="sourceCode r">show_missing_values &lt;-<span class="st"> </span><span class="ot">FALSE</span>
<span class="cf">if</span> (<span class="kw">has_labels</span>(item)) {
  missing_values &lt;-<span class="st"> </span>item[<span class="kw">is.na</span>(haven<span class="op">::</span><span class="kw">zap_missing</span>(item))]
  <span class="kw">attributes</span>(missing_values) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)) {
    <span class="kw">attributes</span>(missing_values)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(missing_values)<span class="op">$</span>labels[<span class="kw">is.na</span>(<span class="kw">attributes</span>(missing_values)<span class="op">$</span>labels)]
    <span class="kw">attributes</span>(item)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)<span class="op">$</span>labels[<span class="op">!</span><span class="kw">is.na</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)]
  }
  <span class="cf">if</span> (<span class="kw">is.double</span>(item)) {
    show_missing_values &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(haven<span class="op">::</span><span class="kw">na_tag</span>(missing_values))) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_missing</span>(item)
  }
  <span class="cf">if</span> (<span class="kw">length</span>(item_attributes<span class="op">$</span>labels) <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.numeric</span>(item)) {
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_labels</span>(item)
  }
}
item_nomiss &lt;-<span class="st"> </span>item[<span class="op">!</span><span class="kw">is.na</span>(item)]

<span class="co"># unnest mc_multiple and so on</span>
<span class="cf">if</span> (
  <span class="kw">is.character</span>(item_nomiss) <span class="op">&amp;&amp;</span>
<span class="st">  </span><span class="kw">any</span>(stringr<span class="op">::</span><span class="kw">str_detect</span>(item_nomiss, stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>))) <span class="op">&amp;&amp;</span>
<span class="st">  </span><span class="op">!</span><span class="kw">is.null</span>(item_info) <span class="op">&amp;&amp;</span>
<span class="st">  </span>(<span class="kw">exists</span>(<span class="st">&quot;type&quot;</span>, item_info) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span><span class="kw">any</span>(stringr<span class="op">::</span><span class="kw">str_detect</span>(item_info<span class="op">$</span>type, 
                            <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;multiple&quot;</span>))))
  ) {
  item_nomiss &lt;-<span class="st"> </span><span class="kw">unlist</span>(stringr<span class="op">::</span><span class="kw">str_split</span>(item_nomiss, <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>)))
}
<span class="kw">attributes</span>(item_nomiss) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)

old_height &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.height&quot;</span>)
non_missing_choices &lt;-<span class="st"> </span>item_attributes[[<span class="st">&quot;labels&quot;</span>]]
many_labels &lt;-<span class="st"> </span><span class="kw">length</span>(non_missing_choices) <span class="op">&gt;</span><span class="st"> </span><span class="dv">7</span>
go_vertical &lt;-<span class="st"> </span><span class="op">!</span><span class="kw">is_numeric_or_time_var</span>(item_nomiss) <span class="op">||</span><span class="st"> </span>many_labels
  
<span class="cf">if</span> ( go_vertical ) {
  <span class="co"># numeric items are plotted horizontally (because that&#39;s what usually expected)</span>
  <span class="co"># categorical items are plotted vertically because we can use the screen real estate better this way</span>

    <span class="cf">if</span> (<span class="kw">is.null</span>(choices) <span class="op">||</span><span class="st"> </span>
<span class="st">        </span>dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss) <span class="op">&gt;</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)) {
        non_missing_choices &lt;-<span class="st"> </span><span class="kw">unique</span>(item_nomiss)
        <span class="kw">names</span>(non_missing_choices) &lt;-<span class="st"> </span>non_missing_choices
    }
  choice_multiplier &lt;-<span class="st"> </span>old_height<span class="op">/</span><span class="fl">6.5</span>
    new_height &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>choice_multiplier <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&gt;</span><span class="st"> </span><span class="dv">20</span>, <span class="dv">20</span>, new_height)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">1</span>, new_height)
    <span class="cf">if</span>(<span class="kw">could_disclose_unique_values</span>(item_nomiss) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.character</span>(item_nomiss)) {
      new_height &lt;-<span class="st"> </span>old_height
    }
    knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> new_height)
}

wrap_at &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.width&quot;</span>) <span class="op">*</span><span class="st"> </span><span class="dv">10</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># todo: if there are free-text choices mingled in with the pre-defined ones, don&#39;t show</span>
<span class="co"># todo: show rare items if they are pre-defined</span>
<span class="co"># todo: bin rare responses into &quot;other category&quot;</span>
<span class="cf">if</span> (<span class="op">!</span><span class="kw">length</span>(item_nomiss)) {
  <span class="kw">cat</span>(<span class="st">&quot;No non-missing values to show.&quot;</span>)
} <span class="cf">else</span> <span class="cf">if</span> (<span class="op">!</span><span class="kw">could_disclose_unique_values</span>(item_nomiss)) {
  <span class="kw">plot_labelled</span>(item_nomiss, item_name, wrap_at, go_vertical)
} <span class="cf">else</span> {
  <span class="cf">if</span> (<span class="kw">is.character</span>(item_nomiss)) {
      char_count &lt;-<span class="st"> </span>stringr<span class="op">::</span><span class="kw">str_count</span>(item_nomiss)
      <span class="kw">attributes</span>(char_count)<span class="op">$</span>label &lt;-<span class="st"> </span>item_label
      <span class="kw">plot_labelled</span>(char_count, 
                    item_name, wrap_at, <span class="ot">FALSE</span>, <span class="dt">trans =</span> <span class="st">&quot;log1p&quot;</span>, <span class="st">&quot;characters&quot;</span>)
  } <span class="cf">else</span> {
      <span class="kw">cat</span>(dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss), <span class="st">&quot; unique, categorical values, so not shown.&quot;</span>)
  }
}</code></pre>
<p><img src="_main_files/figure-html/school_distribution-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> old_height)</code></pre>
<p>0 missing values.</p>
</div>
<div id="school_summary" class="section level4">
<h4><span class="header-section-number">2.2.1.2</span> Summary statistics</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attributes</span>(item) &lt;-<span class="st"> </span>item_attributes
df =<span class="st"> </span><span class="kw">data.frame</span>(item, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
<span class="kw">names</span>(df) =<span class="st"> </span>html_item_name
<span class="kw">escaped_table</span>(<span class="kw">codebook_table</span>(df))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">name</th>
<th align="left">label</th>
<th align="left">data_type</th>
<th align="left">missing</th>
<th align="left">complete</th>
<th align="left">n</th>
<th align="left">mean</th>
<th align="left">sd</th>
<th align="left">p0</th>
<th align="left">p25</th>
<th align="left">p50</th>
<th align="left">p75</th>
<th align="left">p100</th>
<th align="left">hist</th>
<th align="left">format.spss</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">school</td>
<td align="left">school id</td>
<td align="left">numeric</td>
<td align="left">0</td>
<td align="left">407</td>
<td align="left">407</td>
<td align="left">4.51</td>
<td align="left">3.95</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">2</td>
<td align="left">9</td>
<td align="left">13</td>
<td align="left">▇▁▁▁▁▃▁▁</td>
<td align="left">F2.0</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (show_missing_values) {
  <span class="kw">plot_labelled</span>(missing_values, item_name, wrap_at)
}</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(item_info)) {
  <span class="co"># don&#39;t show choices again, if they&#39;re basically same thing as value labels</span>
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.null</span>(item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">names</span>(<span class="kw">na.omit</span>(choices)) <span class="op">==</span><span class="st"> </span>item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">na.omit</span>(choices) <span class="op">==</span><span class="st"> </span><span class="kw">names</span>(item_info<span class="op">$</span>choices))) {
    item_info<span class="op">$</span>choices &lt;-<span class="st"> </span><span class="ot">NULL</span>
  }
  item_info<span class="op">$</span>label_parsed &lt;-<span class="st"> </span>
<span class="st">    </span>item_info<span class="op">$</span>choice_list &lt;-<span class="st"> </span>item_info<span class="op">$</span>study_id &lt;-<span class="st"> </span>item_info<span class="op">$</span>id &lt;-<span class="st"> </span><span class="ot">NULL</span>
  pander<span class="op">::</span><span class="kw">pander</span>(item_info)
}</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span>) {
    pander<span class="op">::</span><span class="kw">pander</span>(<span class="kw">as.list</span>(choices))
}</code></pre>
</div>
</div>
<div id="teacher" class="section level3 tabset">
<h3><span class="header-section-number">2.2.2</span> teacher</h3>
<p>teacher id</p>
<div id="teacher_distribution" class="section level4">
<h4><span class="header-section-number">2.2.2.1</span> Distribution</h4>
<pre class="sourceCode r"><code class="sourceCode r">show_missing_values &lt;-<span class="st"> </span><span class="ot">FALSE</span>
<span class="cf">if</span> (<span class="kw">has_labels</span>(item)) {
  missing_values &lt;-<span class="st"> </span>item[<span class="kw">is.na</span>(haven<span class="op">::</span><span class="kw">zap_missing</span>(item))]
  <span class="kw">attributes</span>(missing_values) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)) {
    <span class="kw">attributes</span>(missing_values)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(missing_values)<span class="op">$</span>labels[<span class="kw">is.na</span>(<span class="kw">attributes</span>(missing_values)<span class="op">$</span>labels)]
    <span class="kw">attributes</span>(item)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)<span class="op">$</span>labels[<span class="op">!</span><span class="kw">is.na</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)]
  }
  <span class="cf">if</span> (<span class="kw">is.double</span>(item)) {
    show_missing_values &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(haven<span class="op">::</span><span class="kw">na_tag</span>(missing_values))) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_missing</span>(item)
  }
  <span class="cf">if</span> (<span class="kw">length</span>(item_attributes<span class="op">$</span>labels) <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.numeric</span>(item)) {
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_labels</span>(item)
  }
}
item_nomiss &lt;-<span class="st"> </span>item[<span class="op">!</span><span class="kw">is.na</span>(item)]

<span class="co"># unnest mc_multiple and so on</span>
<span class="cf">if</span> (
  <span class="kw">is.character</span>(item_nomiss) <span class="op">&amp;&amp;</span>
<span class="st">  </span><span class="kw">any</span>(stringr<span class="op">::</span><span class="kw">str_detect</span>(item_nomiss, stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>))) <span class="op">&amp;&amp;</span>
<span class="st">  </span><span class="op">!</span><span class="kw">is.null</span>(item_info) <span class="op">&amp;&amp;</span>
<span class="st">  </span>(<span class="kw">exists</span>(<span class="st">&quot;type&quot;</span>, item_info) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span><span class="kw">any</span>(stringr<span class="op">::</span><span class="kw">str_detect</span>(item_info<span class="op">$</span>type, 
                            <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;multiple&quot;</span>))))
  ) {
  item_nomiss &lt;-<span class="st"> </span><span class="kw">unlist</span>(stringr<span class="op">::</span><span class="kw">str_split</span>(item_nomiss, <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>)))
}
<span class="kw">attributes</span>(item_nomiss) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)

old_height &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.height&quot;</span>)
non_missing_choices &lt;-<span class="st"> </span>item_attributes[[<span class="st">&quot;labels&quot;</span>]]
many_labels &lt;-<span class="st"> </span><span class="kw">length</span>(non_missing_choices) <span class="op">&gt;</span><span class="st"> </span><span class="dv">7</span>
go_vertical &lt;-<span class="st"> </span><span class="op">!</span><span class="kw">is_numeric_or_time_var</span>(item_nomiss) <span class="op">||</span><span class="st"> </span>many_labels
  
<span class="cf">if</span> ( go_vertical ) {
  <span class="co"># numeric items are plotted horizontally (because that&#39;s what usually expected)</span>
  <span class="co"># categorical items are plotted vertically because we can use the screen real estate better this way</span>

    <span class="cf">if</span> (<span class="kw">is.null</span>(choices) <span class="op">||</span><span class="st"> </span>
<span class="st">        </span>dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss) <span class="op">&gt;</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)) {
        non_missing_choices &lt;-<span class="st"> </span><span class="kw">unique</span>(item_nomiss)
        <span class="kw">names</span>(non_missing_choices) &lt;-<span class="st"> </span>non_missing_choices
    }
  choice_multiplier &lt;-<span class="st"> </span>old_height<span class="op">/</span><span class="fl">6.5</span>
    new_height &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>choice_multiplier <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&gt;</span><span class="st"> </span><span class="dv">20</span>, <span class="dv">20</span>, new_height)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">1</span>, new_height)
    <span class="cf">if</span>(<span class="kw">could_disclose_unique_values</span>(item_nomiss) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.character</span>(item_nomiss)) {
      new_height &lt;-<span class="st"> </span>old_height
    }
    knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> new_height)
}

wrap_at &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.width&quot;</span>) <span class="op">*</span><span class="st"> </span><span class="dv">10</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># todo: if there are free-text choices mingled in with the pre-defined ones, don&#39;t show</span>
<span class="co"># todo: show rare items if they are pre-defined</span>
<span class="co"># todo: bin rare responses into &quot;other category&quot;</span>
<span class="cf">if</span> (<span class="op">!</span><span class="kw">length</span>(item_nomiss)) {
  <span class="kw">cat</span>(<span class="st">&quot;No non-missing values to show.&quot;</span>)
} <span class="cf">else</span> <span class="cf">if</span> (<span class="op">!</span><span class="kw">could_disclose_unique_values</span>(item_nomiss)) {
  <span class="kw">plot_labelled</span>(item_nomiss, item_name, wrap_at, go_vertical)
} <span class="cf">else</span> {
  <span class="cf">if</span> (<span class="kw">is.character</span>(item_nomiss)) {
      char_count &lt;-<span class="st"> </span>stringr<span class="op">::</span><span class="kw">str_count</span>(item_nomiss)
      <span class="kw">attributes</span>(char_count)<span class="op">$</span>label &lt;-<span class="st"> </span>item_label
      <span class="kw">plot_labelled</span>(char_count, 
                    item_name, wrap_at, <span class="ot">FALSE</span>, <span class="dt">trans =</span> <span class="st">&quot;log1p&quot;</span>, <span class="st">&quot;characters&quot;</span>)
  } <span class="cf">else</span> {
      <span class="kw">cat</span>(dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss), <span class="st">&quot; unique, categorical values, so not shown.&quot;</span>)
  }
}</code></pre>
<p><img src="_main_files/figure-html/teacher_distribution-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> old_height)</code></pre>
<p>0 missing values.</p>
</div>
<div id="teacher_summary" class="section level4">
<h4><span class="header-section-number">2.2.2.2</span> Summary statistics</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attributes</span>(item) &lt;-<span class="st"> </span>item_attributes
df =<span class="st"> </span><span class="kw">data.frame</span>(item, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
<span class="kw">names</span>(df) =<span class="st"> </span>html_item_name
<span class="kw">escaped_table</span>(<span class="kw">codebook_table</span>(df))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">name</th>
<th align="left">label</th>
<th align="left">data_type</th>
<th align="left">missing</th>
<th align="left">complete</th>
<th align="left">n</th>
<th align="left">mean</th>
<th align="left">sd</th>
<th align="left">p0</th>
<th align="left">p25</th>
<th align="left">p50</th>
<th align="left">p75</th>
<th align="left">p100</th>
<th align="left">hist</th>
<th align="left">format.spss</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">teacher</td>
<td align="left">teacher id</td>
<td align="left">numeric</td>
<td align="left">0</td>
<td align="left">407</td>
<td align="left">407</td>
<td align="left">10.91</td>
<td align="left">7.71</td>
<td align="left">1</td>
<td align="left">4</td>
<td align="left">8</td>
<td align="left">18</td>
<td align="left">55</td>
<td align="left">▇▃▅▂▁▁▁▁</td>
<td align="left">F2.0</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (show_missing_values) {
  <span class="kw">plot_labelled</span>(missing_values, item_name, wrap_at)
}</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(item_info)) {
  <span class="co"># don&#39;t show choices again, if they&#39;re basically same thing as value labels</span>
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.null</span>(item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">names</span>(<span class="kw">na.omit</span>(choices)) <span class="op">==</span><span class="st"> </span>item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">na.omit</span>(choices) <span class="op">==</span><span class="st"> </span><span class="kw">names</span>(item_info<span class="op">$</span>choices))) {
    item_info<span class="op">$</span>choices &lt;-<span class="st"> </span><span class="ot">NULL</span>
  }
  item_info<span class="op">$</span>label_parsed &lt;-<span class="st"> </span>
<span class="st">    </span>item_info<span class="op">$</span>choice_list &lt;-<span class="st"> </span>item_info<span class="op">$</span>study_id &lt;-<span class="st"> </span>item_info<span class="op">$</span>id &lt;-<span class="st"> </span><span class="ot">NULL</span>
  pander<span class="op">::</span><span class="kw">pander</span>(item_info)
}</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span>) {
    pander<span class="op">::</span><span class="kw">pander</span>(<span class="kw">as.list</span>(choices))
}</code></pre>
</div>
</div>
<div id="id" class="section level3 tabset">
<h3><span class="header-section-number">2.2.3</span> id</h3>
<p>student id</p>
<div id="id_distribution" class="section level4">
<h4><span class="header-section-number">2.2.3.1</span> Distribution</h4>
<pre class="sourceCode r"><code class="sourceCode r">show_missing_values &lt;-<span class="st"> </span><span class="ot">FALSE</span>
<span class="cf">if</span> (<span class="kw">has_labels</span>(item)) {
  missing_values &lt;-<span class="st"> </span>item[<span class="kw">is.na</span>(haven<span class="op">::</span><span class="kw">zap_missing</span>(item))]
  <span class="kw">attributes</span>(missing_values) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)) {
    <span class="kw">attributes</span>(missing_values)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(missing_values)<span class="op">$</span>labels[<span class="kw">is.na</span>(<span class="kw">attributes</span>(missing_values)<span class="op">$</span>labels)]
    <span class="kw">attributes</span>(item)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)<span class="op">$</span>labels[<span class="op">!</span><span class="kw">is.na</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)]
  }
  <span class="cf">if</span> (<span class="kw">is.double</span>(item)) {
    show_missing_values &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(haven<span class="op">::</span><span class="kw">na_tag</span>(missing_values))) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_missing</span>(item)
  }
  <span class="cf">if</span> (<span class="kw">length</span>(item_attributes<span class="op">$</span>labels) <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.numeric</span>(item)) {
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_labels</span>(item)
  }
}
item_nomiss &lt;-<span class="st"> </span>item[<span class="op">!</span><span class="kw">is.na</span>(item)]

<span class="co"># unnest mc_multiple and so on</span>
<span class="cf">if</span> (
  <span class="kw">is.character</span>(item_nomiss) <span class="op">&amp;&amp;</span>
<span class="st">  </span><span class="kw">any</span>(stringr<span class="op">::</span><span class="kw">str_detect</span>(item_nomiss, stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>))) <span class="op">&amp;&amp;</span>
<span class="st">  </span><span class="op">!</span><span class="kw">is.null</span>(item_info) <span class="op">&amp;&amp;</span>
<span class="st">  </span>(<span class="kw">exists</span>(<span class="st">&quot;type&quot;</span>, item_info) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span><span class="kw">any</span>(stringr<span class="op">::</span><span class="kw">str_detect</span>(item_info<span class="op">$</span>type, 
                            <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;multiple&quot;</span>))))
  ) {
  item_nomiss &lt;-<span class="st"> </span><span class="kw">unlist</span>(stringr<span class="op">::</span><span class="kw">str_split</span>(item_nomiss, <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>)))
}
<span class="kw">attributes</span>(item_nomiss) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)

old_height &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.height&quot;</span>)
non_missing_choices &lt;-<span class="st"> </span>item_attributes[[<span class="st">&quot;labels&quot;</span>]]
many_labels &lt;-<span class="st"> </span><span class="kw">length</span>(non_missing_choices) <span class="op">&gt;</span><span class="st"> </span><span class="dv">7</span>
go_vertical &lt;-<span class="st"> </span><span class="op">!</span><span class="kw">is_numeric_or_time_var</span>(item_nomiss) <span class="op">||</span><span class="st"> </span>many_labels
  
<span class="cf">if</span> ( go_vertical ) {
  <span class="co"># numeric items are plotted horizontally (because that&#39;s what usually expected)</span>
  <span class="co"># categorical items are plotted vertically because we can use the screen real estate better this way</span>

    <span class="cf">if</span> (<span class="kw">is.null</span>(choices) <span class="op">||</span><span class="st"> </span>
<span class="st">        </span>dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss) <span class="op">&gt;</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)) {
        non_missing_choices &lt;-<span class="st"> </span><span class="kw">unique</span>(item_nomiss)
        <span class="kw">names</span>(non_missing_choices) &lt;-<span class="st"> </span>non_missing_choices
    }
  choice_multiplier &lt;-<span class="st"> </span>old_height<span class="op">/</span><span class="fl">6.5</span>
    new_height &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>choice_multiplier <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&gt;</span><span class="st"> </span><span class="dv">20</span>, <span class="dv">20</span>, new_height)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">1</span>, new_height)
    <span class="cf">if</span>(<span class="kw">could_disclose_unique_values</span>(item_nomiss) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.character</span>(item_nomiss)) {
      new_height &lt;-<span class="st"> </span>old_height
    }
    knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> new_height)
}

wrap_at &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.width&quot;</span>) <span class="op">*</span><span class="st"> </span><span class="dv">10</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># todo: if there are free-text choices mingled in with the pre-defined ones, don&#39;t show</span>
<span class="co"># todo: show rare items if they are pre-defined</span>
<span class="co"># todo: bin rare responses into &quot;other category&quot;</span>
<span class="cf">if</span> (<span class="op">!</span><span class="kw">length</span>(item_nomiss)) {
  <span class="kw">cat</span>(<span class="st">&quot;No non-missing values to show.&quot;</span>)
} <span class="cf">else</span> <span class="cf">if</span> (<span class="op">!</span><span class="kw">could_disclose_unique_values</span>(item_nomiss)) {
  <span class="kw">plot_labelled</span>(item_nomiss, item_name, wrap_at, go_vertical)
} <span class="cf">else</span> {
  <span class="cf">if</span> (<span class="kw">is.character</span>(item_nomiss)) {
      char_count &lt;-<span class="st"> </span>stringr<span class="op">::</span><span class="kw">str_count</span>(item_nomiss)
      <span class="kw">attributes</span>(char_count)<span class="op">$</span>label &lt;-<span class="st"> </span>item_label
      <span class="kw">plot_labelled</span>(char_count, 
                    item_name, wrap_at, <span class="ot">FALSE</span>, <span class="dt">trans =</span> <span class="st">&quot;log1p&quot;</span>, <span class="st">&quot;characters&quot;</span>)
  } <span class="cf">else</span> {
      <span class="kw">cat</span>(dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss), <span class="st">&quot; unique, categorical values, so not shown.&quot;</span>)
  }
}</code></pre>
<p><img src="_main_files/figure-html/id_distribution-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> old_height)</code></pre>
<p>0 missing values.</p>
</div>
<div id="id_summary" class="section level4">
<h4><span class="header-section-number">2.2.3.2</span> Summary statistics</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attributes</span>(item) &lt;-<span class="st"> </span>item_attributes
df =<span class="st"> </span><span class="kw">data.frame</span>(item, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
<span class="kw">names</span>(df) =<span class="st"> </span>html_item_name
<span class="kw">escaped_table</span>(<span class="kw">codebook_table</span>(df))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">name</th>
<th align="left">label</th>
<th align="left">data_type</th>
<th align="left">missing</th>
<th align="left">complete</th>
<th align="left">n</th>
<th align="left">mean</th>
<th align="left">sd</th>
<th align="left">p0</th>
<th align="left">p25</th>
<th align="left">p50</th>
<th align="left">p75</th>
<th align="left">p100</th>
<th align="left">hist</th>
<th align="left">format.spss</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">id</td>
<td align="left">student id</td>
<td align="left">numeric</td>
<td align="left">0</td>
<td align="left">407</td>
<td align="left">407</td>
<td align="left">32.12</td>
<td align="left">15.7</td>
<td align="left">1</td>
<td align="left">20</td>
<td align="left">35</td>
<td align="left">44</td>
<td align="left">61</td>
<td align="left">▃▃▂▃▇▆▅▂</td>
<td align="left">F2.0</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (show_missing_values) {
  <span class="kw">plot_labelled</span>(missing_values, item_name, wrap_at)
}</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(item_info)) {
  <span class="co"># don&#39;t show choices again, if they&#39;re basically same thing as value labels</span>
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.null</span>(item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">names</span>(<span class="kw">na.omit</span>(choices)) <span class="op">==</span><span class="st"> </span>item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">na.omit</span>(choices) <span class="op">==</span><span class="st"> </span><span class="kw">names</span>(item_info<span class="op">$</span>choices))) {
    item_info<span class="op">$</span>choices &lt;-<span class="st"> </span><span class="ot">NULL</span>
  }
  item_info<span class="op">$</span>label_parsed &lt;-<span class="st"> </span>
<span class="st">    </span>item_info<span class="op">$</span>choice_list &lt;-<span class="st"> </span>item_info<span class="op">$</span>study_id &lt;-<span class="st"> </span>item_info<span class="op">$</span>id &lt;-<span class="st"> </span><span class="ot">NULL</span>
  pander<span class="op">::</span><span class="kw">pander</span>(item_info)
}</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span>) {
    pander<span class="op">::</span><span class="kw">pander</span>(<span class="kw">as.list</span>(choices))
}</code></pre>
</div>
</div>
<div id="group" class="section level3 tabset">
<h3><span class="header-section-number">2.2.4</span> group</h3>
<p>Achievement Level</p>
<div id="group_distribution" class="section level4">
<h4><span class="header-section-number">2.2.4.1</span> Distribution</h4>
<pre class="sourceCode r"><code class="sourceCode r">show_missing_values &lt;-<span class="st"> </span><span class="ot">FALSE</span>
<span class="cf">if</span> (<span class="kw">has_labels</span>(item)) {
  missing_values &lt;-<span class="st"> </span>item[<span class="kw">is.na</span>(haven<span class="op">::</span><span class="kw">zap_missing</span>(item))]
  <span class="kw">attributes</span>(missing_values) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)) {
    <span class="kw">attributes</span>(missing_values)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(missing_values)<span class="op">$</span>labels[<span class="kw">is.na</span>(<span class="kw">attributes</span>(missing_values)<span class="op">$</span>labels)]
    <span class="kw">attributes</span>(item)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)<span class="op">$</span>labels[<span class="op">!</span><span class="kw">is.na</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)]
  }
  <span class="cf">if</span> (<span class="kw">is.double</span>(item)) {
    show_missing_values &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(haven<span class="op">::</span><span class="kw">na_tag</span>(missing_values))) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_missing</span>(item)
  }
  <span class="cf">if</span> (<span class="kw">length</span>(item_attributes<span class="op">$</span>labels) <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.numeric</span>(item)) {
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_labels</span>(item)
  }
}
item_nomiss &lt;-<span class="st"> </span>item[<span class="op">!</span><span class="kw">is.na</span>(item)]

<span class="co"># unnest mc_multiple and so on</span>
<span class="cf">if</span> (
  <span class="kw">is.character</span>(item_nomiss) <span class="op">&amp;&amp;</span>
<span class="st">  </span><span class="kw">any</span>(stringr<span class="op">::</span><span class="kw">str_detect</span>(item_nomiss, stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>))) <span class="op">&amp;&amp;</span>
<span class="st">  </span><span class="op">!</span><span class="kw">is.null</span>(item_info) <span class="op">&amp;&amp;</span>
<span class="st">  </span>(<span class="kw">exists</span>(<span class="st">&quot;type&quot;</span>, item_info) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span><span class="kw">any</span>(stringr<span class="op">::</span><span class="kw">str_detect</span>(item_info<span class="op">$</span>type, 
                            <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;multiple&quot;</span>))))
  ) {
  item_nomiss &lt;-<span class="st"> </span><span class="kw">unlist</span>(stringr<span class="op">::</span><span class="kw">str_split</span>(item_nomiss, <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>)))
}
<span class="kw">attributes</span>(item_nomiss) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)

old_height &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.height&quot;</span>)
non_missing_choices &lt;-<span class="st"> </span>item_attributes[[<span class="st">&quot;labels&quot;</span>]]
many_labels &lt;-<span class="st"> </span><span class="kw">length</span>(non_missing_choices) <span class="op">&gt;</span><span class="st"> </span><span class="dv">7</span>
go_vertical &lt;-<span class="st"> </span><span class="op">!</span><span class="kw">is_numeric_or_time_var</span>(item_nomiss) <span class="op">||</span><span class="st"> </span>many_labels
  
<span class="cf">if</span> ( go_vertical ) {
  <span class="co"># numeric items are plotted horizontally (because that&#39;s what usually expected)</span>
  <span class="co"># categorical items are plotted vertically because we can use the screen real estate better this way</span>

    <span class="cf">if</span> (<span class="kw">is.null</span>(choices) <span class="op">||</span><span class="st"> </span>
<span class="st">        </span>dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss) <span class="op">&gt;</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)) {
        non_missing_choices &lt;-<span class="st"> </span><span class="kw">unique</span>(item_nomiss)
        <span class="kw">names</span>(non_missing_choices) &lt;-<span class="st"> </span>non_missing_choices
    }
  choice_multiplier &lt;-<span class="st"> </span>old_height<span class="op">/</span><span class="fl">6.5</span>
    new_height &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>choice_multiplier <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&gt;</span><span class="st"> </span><span class="dv">20</span>, <span class="dv">20</span>, new_height)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">1</span>, new_height)
    <span class="cf">if</span>(<span class="kw">could_disclose_unique_values</span>(item_nomiss) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.character</span>(item_nomiss)) {
      new_height &lt;-<span class="st"> </span>old_height
    }
    knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> new_height)
}

wrap_at &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.width&quot;</span>) <span class="op">*</span><span class="st"> </span><span class="dv">10</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># todo: if there are free-text choices mingled in with the pre-defined ones, don&#39;t show</span>
<span class="co"># todo: show rare items if they are pre-defined</span>
<span class="co"># todo: bin rare responses into &quot;other category&quot;</span>
<span class="cf">if</span> (<span class="op">!</span><span class="kw">length</span>(item_nomiss)) {
  <span class="kw">cat</span>(<span class="st">&quot;No non-missing values to show.&quot;</span>)
} <span class="cf">else</span> <span class="cf">if</span> (<span class="op">!</span><span class="kw">could_disclose_unique_values</span>(item_nomiss)) {
  <span class="kw">plot_labelled</span>(item_nomiss, item_name, wrap_at, go_vertical)
} <span class="cf">else</span> {
  <span class="cf">if</span> (<span class="kw">is.character</span>(item_nomiss)) {
      char_count &lt;-<span class="st"> </span>stringr<span class="op">::</span><span class="kw">str_count</span>(item_nomiss)
      <span class="kw">attributes</span>(char_count)<span class="op">$</span>label &lt;-<span class="st"> </span>item_label
      <span class="kw">plot_labelled</span>(char_count, 
                    item_name, wrap_at, <span class="ot">FALSE</span>, <span class="dt">trans =</span> <span class="st">&quot;log1p&quot;</span>, <span class="st">&quot;characters&quot;</span>)
  } <span class="cf">else</span> {
      <span class="kw">cat</span>(dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss), <span class="st">&quot; unique, categorical values, so not shown.&quot;</span>)
  }
}</code></pre>
<p><img src="_main_files/figure-html/group_distribution-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> old_height)</code></pre>
<p>40 missing values.</p>
</div>
<div id="group_summary" class="section level4">
<h4><span class="header-section-number">2.2.4.2</span> Summary statistics</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attributes</span>(item) &lt;-<span class="st"> </span>item_attributes
df =<span class="st"> </span><span class="kw">data.frame</span>(item, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
<span class="kw">names</span>(df) =<span class="st"> </span>html_item_name
<span class="kw">escaped_table</span>(<span class="kw">codebook_table</span>(df))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">name</th>
<th align="left">label</th>
<th align="left">data_type</th>
<th align="left">value_labels</th>
<th align="left">missing</th>
<th align="left">complete</th>
<th align="left">n</th>
<th align="left">mean</th>
<th align="left">sd</th>
<th align="left">p0</th>
<th align="left">p25</th>
<th align="left">p50</th>
<th align="left">p75</th>
<th align="left">p100</th>
<th align="left">hist</th>
<th align="left">format.spss</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">group</td>
<td align="left">Achievement Level</td>
<td align="left">numeric</td>
<td align="left">1. High achieving,<br>2. Average achieving,<br>3. Low achieving,<br>4. Learning disabled</td>
<td align="left">40</td>
<td align="left">367</td>
<td align="left">407</td>
<td align="left">2.66</td>
<td align="left">1.17</td>
<td align="left">1</td>
<td align="left">2</td>
<td align="left">3</td>
<td align="left">4</td>
<td align="left">4</td>
<td align="left">▆▁▅▁▁▅▁▇</td>
<td align="left">F2.0</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (show_missing_values) {
  <span class="kw">plot_labelled</span>(missing_values, item_name, wrap_at)
}</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(item_info)) {
  <span class="co"># don&#39;t show choices again, if they&#39;re basically same thing as value labels</span>
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.null</span>(item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">names</span>(<span class="kw">na.omit</span>(choices)) <span class="op">==</span><span class="st"> </span>item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">na.omit</span>(choices) <span class="op">==</span><span class="st"> </span><span class="kw">names</span>(item_info<span class="op">$</span>choices))) {
    item_info<span class="op">$</span>choices &lt;-<span class="st"> </span><span class="ot">NULL</span>
  }
  item_info<span class="op">$</span>label_parsed &lt;-<span class="st"> </span>
<span class="st">    </span>item_info<span class="op">$</span>choice_list &lt;-<span class="st"> </span>item_info<span class="op">$</span>study_id &lt;-<span class="st"> </span>item_info<span class="op">$</span>id &lt;-<span class="st"> </span><span class="ot">NULL</span>
  pander<span class="op">::</span><span class="kw">pander</span>(item_info)
}</code></pre>
</div>
<div id="group_labels" class="section level4">
<h4><span class="header-section-number">2.2.4.3</span> Value labels</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span>) {
    pander<span class="op">::</span><span class="kw">pander</span>(<span class="kw">as.list</span>(choices))
}</code></pre>
<ul>
<li><strong>High achieving</strong>: <em>1</em></li>
<li><strong>Average achieving</strong>: <em>2</em></li>
<li><strong>Low achieving</strong>: <em>3</em></li>
<li><strong>Learning disabled</strong>: <em>4</em></li>
</ul>
<!-- end of list -->
</div>
</div>
<div id="treatmt" class="section level3 tabset">
<h3><span class="header-section-number">2.2.5</span> treatmt</h3>
<p>treatment condition</p>
<div id="treatmt_distribution" class="section level4">
<h4><span class="header-section-number">2.2.5.1</span> Distribution</h4>
<pre class="sourceCode r"><code class="sourceCode r">show_missing_values &lt;-<span class="st"> </span><span class="ot">FALSE</span>
<span class="cf">if</span> (<span class="kw">has_labels</span>(item)) {
  missing_values &lt;-<span class="st"> </span>item[<span class="kw">is.na</span>(haven<span class="op">::</span><span class="kw">zap_missing</span>(item))]
  <span class="kw">attributes</span>(missing_values) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)) {
    <span class="kw">attributes</span>(missing_values)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(missing_values)<span class="op">$</span>labels[<span class="kw">is.na</span>(<span class="kw">attributes</span>(missing_values)<span class="op">$</span>labels)]
    <span class="kw">attributes</span>(item)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)<span class="op">$</span>labels[<span class="op">!</span><span class="kw">is.na</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)]
  }
  <span class="cf">if</span> (<span class="kw">is.double</span>(item)) {
    show_missing_values &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(haven<span class="op">::</span><span class="kw">na_tag</span>(missing_values))) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_missing</span>(item)
  }
  <span class="cf">if</span> (<span class="kw">length</span>(item_attributes<span class="op">$</span>labels) <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.numeric</span>(item)) {
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_labels</span>(item)
  }
}
item_nomiss &lt;-<span class="st"> </span>item[<span class="op">!</span><span class="kw">is.na</span>(item)]

<span class="co"># unnest mc_multiple and so on</span>
<span class="cf">if</span> (
  <span class="kw">is.character</span>(item_nomiss) <span class="op">&amp;&amp;</span>
<span class="st">  </span><span class="kw">any</span>(stringr<span class="op">::</span><span class="kw">str_detect</span>(item_nomiss, stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>))) <span class="op">&amp;&amp;</span>
<span class="st">  </span><span class="op">!</span><span class="kw">is.null</span>(item_info) <span class="op">&amp;&amp;</span>
<span class="st">  </span>(<span class="kw">exists</span>(<span class="st">&quot;type&quot;</span>, item_info) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span><span class="kw">any</span>(stringr<span class="op">::</span><span class="kw">str_detect</span>(item_info<span class="op">$</span>type, 
                            <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;multiple&quot;</span>))))
  ) {
  item_nomiss &lt;-<span class="st"> </span><span class="kw">unlist</span>(stringr<span class="op">::</span><span class="kw">str_split</span>(item_nomiss, <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>)))
}
<span class="kw">attributes</span>(item_nomiss) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)

old_height &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.height&quot;</span>)
non_missing_choices &lt;-<span class="st"> </span>item_attributes[[<span class="st">&quot;labels&quot;</span>]]
many_labels &lt;-<span class="st"> </span><span class="kw">length</span>(non_missing_choices) <span class="op">&gt;</span><span class="st"> </span><span class="dv">7</span>
go_vertical &lt;-<span class="st"> </span><span class="op">!</span><span class="kw">is_numeric_or_time_var</span>(item_nomiss) <span class="op">||</span><span class="st"> </span>many_labels
  
<span class="cf">if</span> ( go_vertical ) {
  <span class="co"># numeric items are plotted horizontally (because that&#39;s what usually expected)</span>
  <span class="co"># categorical items are plotted vertically because we can use the screen real estate better this way</span>

    <span class="cf">if</span> (<span class="kw">is.null</span>(choices) <span class="op">||</span><span class="st"> </span>
<span class="st">        </span>dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss) <span class="op">&gt;</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)) {
        non_missing_choices &lt;-<span class="st"> </span><span class="kw">unique</span>(item_nomiss)
        <span class="kw">names</span>(non_missing_choices) &lt;-<span class="st"> </span>non_missing_choices
    }
  choice_multiplier &lt;-<span class="st"> </span>old_height<span class="op">/</span><span class="fl">6.5</span>
    new_height &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>choice_multiplier <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&gt;</span><span class="st"> </span><span class="dv">20</span>, <span class="dv">20</span>, new_height)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">1</span>, new_height)
    <span class="cf">if</span>(<span class="kw">could_disclose_unique_values</span>(item_nomiss) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.character</span>(item_nomiss)) {
      new_height &lt;-<span class="st"> </span>old_height
    }
    knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> new_height)
}

wrap_at &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.width&quot;</span>) <span class="op">*</span><span class="st"> </span><span class="dv">10</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># todo: if there are free-text choices mingled in with the pre-defined ones, don&#39;t show</span>
<span class="co"># todo: show rare items if they are pre-defined</span>
<span class="co"># todo: bin rare responses into &quot;other category&quot;</span>
<span class="cf">if</span> (<span class="op">!</span><span class="kw">length</span>(item_nomiss)) {
  <span class="kw">cat</span>(<span class="st">&quot;No non-missing values to show.&quot;</span>)
} <span class="cf">else</span> <span class="cf">if</span> (<span class="op">!</span><span class="kw">could_disclose_unique_values</span>(item_nomiss)) {
  <span class="kw">plot_labelled</span>(item_nomiss, item_name, wrap_at, go_vertical)
} <span class="cf">else</span> {
  <span class="cf">if</span> (<span class="kw">is.character</span>(item_nomiss)) {
      char_count &lt;-<span class="st"> </span>stringr<span class="op">::</span><span class="kw">str_count</span>(item_nomiss)
      <span class="kw">attributes</span>(char_count)<span class="op">$</span>label &lt;-<span class="st"> </span>item_label
      <span class="kw">plot_labelled</span>(char_count, 
                    item_name, wrap_at, <span class="ot">FALSE</span>, <span class="dt">trans =</span> <span class="st">&quot;log1p&quot;</span>, <span class="st">&quot;characters&quot;</span>)
  } <span class="cf">else</span> {
      <span class="kw">cat</span>(dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss), <span class="st">&quot; unique, categorical values, so not shown.&quot;</span>)
  }
}</code></pre>
<p><img src="_main_files/figure-html/treatmt_distribution-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> old_height)</code></pre>
<p>0 missing values.</p>
</div>
<div id="treatmt_summary" class="section level4">
<h4><span class="header-section-number">2.2.5.2</span> Summary statistics</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attributes</span>(item) &lt;-<span class="st"> </span>item_attributes
df =<span class="st"> </span><span class="kw">data.frame</span>(item, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
<span class="kw">names</span>(df) =<span class="st"> </span>html_item_name
<span class="kw">escaped_table</span>(<span class="kw">codebook_table</span>(df))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">name</th>
<th align="left">label</th>
<th align="left">data_type</th>
<th align="left">value_labels</th>
<th align="left">missing</th>
<th align="left">complete</th>
<th align="left">n</th>
<th align="left">mean</th>
<th align="left">sd</th>
<th align="left">p0</th>
<th align="left">p25</th>
<th align="left">p50</th>
<th align="left">p75</th>
<th align="left">p100</th>
<th align="left">hist</th>
<th align="left">format.spss</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">treatmt</td>
<td align="left">treatment condition</td>
<td align="left">numeric</td>
<td align="left">1. Experimental,<br>2. Control</td>
<td align="left">0</td>
<td align="left">407</td>
<td align="left">407</td>
<td align="left">1.3</td>
<td align="left">0.46</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">2</td>
<td align="left">2</td>
<td align="left">▇▁▁▁▁▁▁▃</td>
<td align="left">F2.0</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (show_missing_values) {
  <span class="kw">plot_labelled</span>(missing_values, item_name, wrap_at)
}</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(item_info)) {
  <span class="co"># don&#39;t show choices again, if they&#39;re basically same thing as value labels</span>
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.null</span>(item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">names</span>(<span class="kw">na.omit</span>(choices)) <span class="op">==</span><span class="st"> </span>item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">na.omit</span>(choices) <span class="op">==</span><span class="st"> </span><span class="kw">names</span>(item_info<span class="op">$</span>choices))) {
    item_info<span class="op">$</span>choices &lt;-<span class="st"> </span><span class="ot">NULL</span>
  }
  item_info<span class="op">$</span>label_parsed &lt;-<span class="st"> </span>
<span class="st">    </span>item_info<span class="op">$</span>choice_list &lt;-<span class="st"> </span>item_info<span class="op">$</span>study_id &lt;-<span class="st"> </span>item_info<span class="op">$</span>id &lt;-<span class="st"> </span><span class="ot">NULL</span>
  pander<span class="op">::</span><span class="kw">pander</span>(item_info)
}</code></pre>
</div>
<div id="treatmt_labels" class="section level4">
<h4><span class="header-section-number">2.2.5.3</span> Value labels</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span>) {
    pander<span class="op">::</span><span class="kw">pander</span>(<span class="kw">as.list</span>(choices))
}</code></pre>
<ul>
<li><strong>Experimental</strong>: <em>1</em></li>
<li><strong>Control</strong>: <em>2</em></li>
</ul>
<!-- end of list -->
</div>
</div>
<div id="cch1" class="section level3 tabset">
<h3><span class="header-section-number">2.2.6</span> cch1</h3>
<p>holistic, pretest</p>
<div id="cch1_distribution" class="section level4">
<h4><span class="header-section-number">2.2.6.1</span> Distribution</h4>
<pre class="sourceCode r"><code class="sourceCode r">show_missing_values &lt;-<span class="st"> </span><span class="ot">FALSE</span>
<span class="cf">if</span> (<span class="kw">has_labels</span>(item)) {
  missing_values &lt;-<span class="st"> </span>item[<span class="kw">is.na</span>(haven<span class="op">::</span><span class="kw">zap_missing</span>(item))]
  <span class="kw">attributes</span>(missing_values) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)) {
    <span class="kw">attributes</span>(missing_values)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(missing_values)<span class="op">$</span>labels[<span class="kw">is.na</span>(<span class="kw">attributes</span>(missing_values)<span class="op">$</span>labels)]
    <span class="kw">attributes</span>(item)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)<span class="op">$</span>labels[<span class="op">!</span><span class="kw">is.na</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)]
  }
  <span class="cf">if</span> (<span class="kw">is.double</span>(item)) {
    show_missing_values &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(haven<span class="op">::</span><span class="kw">na_tag</span>(missing_values))) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_missing</span>(item)
  }
  <span class="cf">if</span> (<span class="kw">length</span>(item_attributes<span class="op">$</span>labels) <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.numeric</span>(item)) {
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_labels</span>(item)
  }
}
item_nomiss &lt;-<span class="st"> </span>item[<span class="op">!</span><span class="kw">is.na</span>(item)]

<span class="co"># unnest mc_multiple and so on</span>
<span class="cf">if</span> (
  <span class="kw">is.character</span>(item_nomiss) <span class="op">&amp;&amp;</span>
<span class="st">  </span><span class="kw">any</span>(stringr<span class="op">::</span><span class="kw">str_detect</span>(item_nomiss, stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>))) <span class="op">&amp;&amp;</span>
<span class="st">  </span><span class="op">!</span><span class="kw">is.null</span>(item_info) <span class="op">&amp;&amp;</span>
<span class="st">  </span>(<span class="kw">exists</span>(<span class="st">&quot;type&quot;</span>, item_info) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span><span class="kw">any</span>(stringr<span class="op">::</span><span class="kw">str_detect</span>(item_info<span class="op">$</span>type, 
                            <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;multiple&quot;</span>))))
  ) {
  item_nomiss &lt;-<span class="st"> </span><span class="kw">unlist</span>(stringr<span class="op">::</span><span class="kw">str_split</span>(item_nomiss, <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>)))
}
<span class="kw">attributes</span>(item_nomiss) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)

old_height &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.height&quot;</span>)
non_missing_choices &lt;-<span class="st"> </span>item_attributes[[<span class="st">&quot;labels&quot;</span>]]
many_labels &lt;-<span class="st"> </span><span class="kw">length</span>(non_missing_choices) <span class="op">&gt;</span><span class="st"> </span><span class="dv">7</span>
go_vertical &lt;-<span class="st"> </span><span class="op">!</span><span class="kw">is_numeric_or_time_var</span>(item_nomiss) <span class="op">||</span><span class="st"> </span>many_labels
  
<span class="cf">if</span> ( go_vertical ) {
  <span class="co"># numeric items are plotted horizontally (because that&#39;s what usually expected)</span>
  <span class="co"># categorical items are plotted vertically because we can use the screen real estate better this way</span>

    <span class="cf">if</span> (<span class="kw">is.null</span>(choices) <span class="op">||</span><span class="st"> </span>
<span class="st">        </span>dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss) <span class="op">&gt;</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)) {
        non_missing_choices &lt;-<span class="st"> </span><span class="kw">unique</span>(item_nomiss)
        <span class="kw">names</span>(non_missing_choices) &lt;-<span class="st"> </span>non_missing_choices
    }
  choice_multiplier &lt;-<span class="st"> </span>old_height<span class="op">/</span><span class="fl">6.5</span>
    new_height &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>choice_multiplier <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&gt;</span><span class="st"> </span><span class="dv">20</span>, <span class="dv">20</span>, new_height)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">1</span>, new_height)
    <span class="cf">if</span>(<span class="kw">could_disclose_unique_values</span>(item_nomiss) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.character</span>(item_nomiss)) {
      new_height &lt;-<span class="st"> </span>old_height
    }
    knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> new_height)
}

wrap_at &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.width&quot;</span>) <span class="op">*</span><span class="st"> </span><span class="dv">10</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># todo: if there are free-text choices mingled in with the pre-defined ones, don&#39;t show</span>
<span class="co"># todo: show rare items if they are pre-defined</span>
<span class="co"># todo: bin rare responses into &quot;other category&quot;</span>
<span class="cf">if</span> (<span class="op">!</span><span class="kw">length</span>(item_nomiss)) {
  <span class="kw">cat</span>(<span class="st">&quot;No non-missing values to show.&quot;</span>)
} <span class="cf">else</span> <span class="cf">if</span> (<span class="op">!</span><span class="kw">could_disclose_unique_values</span>(item_nomiss)) {
  <span class="kw">plot_labelled</span>(item_nomiss, item_name, wrap_at, go_vertical)
} <span class="cf">else</span> {
  <span class="cf">if</span> (<span class="kw">is.character</span>(item_nomiss)) {
      char_count &lt;-<span class="st"> </span>stringr<span class="op">::</span><span class="kw">str_count</span>(item_nomiss)
      <span class="kw">attributes</span>(char_count)<span class="op">$</span>label &lt;-<span class="st"> </span>item_label
      <span class="kw">plot_labelled</span>(char_count, 
                    item_name, wrap_at, <span class="ot">FALSE</span>, <span class="dt">trans =</span> <span class="st">&quot;log1p&quot;</span>, <span class="st">&quot;characters&quot;</span>)
  } <span class="cf">else</span> {
      <span class="kw">cat</span>(dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss), <span class="st">&quot; unique, categorical values, so not shown.&quot;</span>)
  }
}</code></pre>
<p><img src="_main_files/figure-html/cch1_distribution-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> old_height)</code></pre>
<p>79 missing values.</p>
</div>
<div id="cch1_summary" class="section level4">
<h4><span class="header-section-number">2.2.6.2</span> Summary statistics</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attributes</span>(item) &lt;-<span class="st"> </span>item_attributes
df =<span class="st"> </span><span class="kw">data.frame</span>(item, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
<span class="kw">names</span>(df) =<span class="st"> </span>html_item_name
<span class="kw">escaped_table</span>(<span class="kw">codebook_table</span>(df))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">name</th>
<th align="left">label</th>
<th align="left">data_type</th>
<th align="left">missing</th>
<th align="left">complete</th>
<th align="left">n</th>
<th align="left">mean</th>
<th align="left">sd</th>
<th align="left">p0</th>
<th align="left">p25</th>
<th align="left">p50</th>
<th align="left">p75</th>
<th align="left">p100</th>
<th align="left">hist</th>
<th align="left">format.spss</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">cch1</td>
<td align="left">holistic, pretest</td>
<td align="left">numeric</td>
<td align="left">79</td>
<td align="left">328</td>
<td align="left">407</td>
<td align="left">1.14</td>
<td align="left">0.76</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">2</td>
<td align="left">3</td>
<td align="left">▃▁▇▁▁▆▁▁</td>
<td align="left">F2.0</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (show_missing_values) {
  <span class="kw">plot_labelled</span>(missing_values, item_name, wrap_at)
}</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(item_info)) {
  <span class="co"># don&#39;t show choices again, if they&#39;re basically same thing as value labels</span>
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.null</span>(item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">names</span>(<span class="kw">na.omit</span>(choices)) <span class="op">==</span><span class="st"> </span>item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">na.omit</span>(choices) <span class="op">==</span><span class="st"> </span><span class="kw">names</span>(item_info<span class="op">$</span>choices))) {
    item_info<span class="op">$</span>choices &lt;-<span class="st"> </span><span class="ot">NULL</span>
  }
  item_info<span class="op">$</span>label_parsed &lt;-<span class="st"> </span>
<span class="st">    </span>item_info<span class="op">$</span>choice_list &lt;-<span class="st"> </span>item_info<span class="op">$</span>study_id &lt;-<span class="st"> </span>item_info<span class="op">$</span>id &lt;-<span class="st"> </span><span class="ot">NULL</span>
  pander<span class="op">::</span><span class="kw">pander</span>(item_info)
}</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span>) {
    pander<span class="op">::</span><span class="kw">pander</span>(<span class="kw">as.list</span>(choices))
}</code></pre>
</div>
</div>
<div id="cch2" class="section level3 tabset">
<h3><span class="header-section-number">2.2.7</span> cch2</h3>
<p>holistic, posttest</p>
<div id="cch2_distribution" class="section level4">
<h4><span class="header-section-number">2.2.7.1</span> Distribution</h4>
<pre class="sourceCode r"><code class="sourceCode r">show_missing_values &lt;-<span class="st"> </span><span class="ot">FALSE</span>
<span class="cf">if</span> (<span class="kw">has_labels</span>(item)) {
  missing_values &lt;-<span class="st"> </span>item[<span class="kw">is.na</span>(haven<span class="op">::</span><span class="kw">zap_missing</span>(item))]
  <span class="kw">attributes</span>(missing_values) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)) {
    <span class="kw">attributes</span>(missing_values)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(missing_values)<span class="op">$</span>labels[<span class="kw">is.na</span>(<span class="kw">attributes</span>(missing_values)<span class="op">$</span>labels)]
    <span class="kw">attributes</span>(item)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)<span class="op">$</span>labels[<span class="op">!</span><span class="kw">is.na</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)]
  }
  <span class="cf">if</span> (<span class="kw">is.double</span>(item)) {
    show_missing_values &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(haven<span class="op">::</span><span class="kw">na_tag</span>(missing_values))) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_missing</span>(item)
  }
  <span class="cf">if</span> (<span class="kw">length</span>(item_attributes<span class="op">$</span>labels) <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.numeric</span>(item)) {
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_labels</span>(item)
  }
}
item_nomiss &lt;-<span class="st"> </span>item[<span class="op">!</span><span class="kw">is.na</span>(item)]

<span class="co"># unnest mc_multiple and so on</span>
<span class="cf">if</span> (
  <span class="kw">is.character</span>(item_nomiss) <span class="op">&amp;&amp;</span>
<span class="st">  </span><span class="kw">any</span>(stringr<span class="op">::</span><span class="kw">str_detect</span>(item_nomiss, stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>))) <span class="op">&amp;&amp;</span>
<span class="st">  </span><span class="op">!</span><span class="kw">is.null</span>(item_info) <span class="op">&amp;&amp;</span>
<span class="st">  </span>(<span class="kw">exists</span>(<span class="st">&quot;type&quot;</span>, item_info) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span><span class="kw">any</span>(stringr<span class="op">::</span><span class="kw">str_detect</span>(item_info<span class="op">$</span>type, 
                            <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;multiple&quot;</span>))))
  ) {
  item_nomiss &lt;-<span class="st"> </span><span class="kw">unlist</span>(stringr<span class="op">::</span><span class="kw">str_split</span>(item_nomiss, <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>)))
}
<span class="kw">attributes</span>(item_nomiss) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)

old_height &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.height&quot;</span>)
non_missing_choices &lt;-<span class="st"> </span>item_attributes[[<span class="st">&quot;labels&quot;</span>]]
many_labels &lt;-<span class="st"> </span><span class="kw">length</span>(non_missing_choices) <span class="op">&gt;</span><span class="st"> </span><span class="dv">7</span>
go_vertical &lt;-<span class="st"> </span><span class="op">!</span><span class="kw">is_numeric_or_time_var</span>(item_nomiss) <span class="op">||</span><span class="st"> </span>many_labels
  
<span class="cf">if</span> ( go_vertical ) {
  <span class="co"># numeric items are plotted horizontally (because that&#39;s what usually expected)</span>
  <span class="co"># categorical items are plotted vertically because we can use the screen real estate better this way</span>

    <span class="cf">if</span> (<span class="kw">is.null</span>(choices) <span class="op">||</span><span class="st"> </span>
<span class="st">        </span>dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss) <span class="op">&gt;</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)) {
        non_missing_choices &lt;-<span class="st"> </span><span class="kw">unique</span>(item_nomiss)
        <span class="kw">names</span>(non_missing_choices) &lt;-<span class="st"> </span>non_missing_choices
    }
  choice_multiplier &lt;-<span class="st"> </span>old_height<span class="op">/</span><span class="fl">6.5</span>
    new_height &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>choice_multiplier <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&gt;</span><span class="st"> </span><span class="dv">20</span>, <span class="dv">20</span>, new_height)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">1</span>, new_height)
    <span class="cf">if</span>(<span class="kw">could_disclose_unique_values</span>(item_nomiss) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.character</span>(item_nomiss)) {
      new_height &lt;-<span class="st"> </span>old_height
    }
    knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> new_height)
}

wrap_at &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.width&quot;</span>) <span class="op">*</span><span class="st"> </span><span class="dv">10</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># todo: if there are free-text choices mingled in with the pre-defined ones, don&#39;t show</span>
<span class="co"># todo: show rare items if they are pre-defined</span>
<span class="co"># todo: bin rare responses into &quot;other category&quot;</span>
<span class="cf">if</span> (<span class="op">!</span><span class="kw">length</span>(item_nomiss)) {
  <span class="kw">cat</span>(<span class="st">&quot;No non-missing values to show.&quot;</span>)
} <span class="cf">else</span> <span class="cf">if</span> (<span class="op">!</span><span class="kw">could_disclose_unique_values</span>(item_nomiss)) {
  <span class="kw">plot_labelled</span>(item_nomiss, item_name, wrap_at, go_vertical)
} <span class="cf">else</span> {
  <span class="cf">if</span> (<span class="kw">is.character</span>(item_nomiss)) {
      char_count &lt;-<span class="st"> </span>stringr<span class="op">::</span><span class="kw">str_count</span>(item_nomiss)
      <span class="kw">attributes</span>(char_count)<span class="op">$</span>label &lt;-<span class="st"> </span>item_label
      <span class="kw">plot_labelled</span>(char_count, 
                    item_name, wrap_at, <span class="ot">FALSE</span>, <span class="dt">trans =</span> <span class="st">&quot;log1p&quot;</span>, <span class="st">&quot;characters&quot;</span>)
  } <span class="cf">else</span> {
      <span class="kw">cat</span>(dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss), <span class="st">&quot; unique, categorical values, so not shown.&quot;</span>)
  }
}</code></pre>
<p><img src="_main_files/figure-html/cch2_distribution-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> old_height)</code></pre>
<p>81 missing values.</p>
</div>
<div id="cch2_summary" class="section level4">
<h4><span class="header-section-number">2.2.7.2</span> Summary statistics</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attributes</span>(item) &lt;-<span class="st"> </span>item_attributes
df =<span class="st"> </span><span class="kw">data.frame</span>(item, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
<span class="kw">names</span>(df) =<span class="st"> </span>html_item_name
<span class="kw">escaped_table</span>(<span class="kw">codebook_table</span>(df))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">name</th>
<th align="left">label</th>
<th align="left">data_type</th>
<th align="left">missing</th>
<th align="left">complete</th>
<th align="left">n</th>
<th align="left">mean</th>
<th align="left">sd</th>
<th align="left">p0</th>
<th align="left">p25</th>
<th align="left">p50</th>
<th align="left">p75</th>
<th align="left">p100</th>
<th align="left">hist</th>
<th align="left">format.spss</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">cch2</td>
<td align="left">holistic, posttest</td>
<td align="left">numeric</td>
<td align="left">81</td>
<td align="left">326</td>
<td align="left">407</td>
<td align="left">1.66</td>
<td align="left">0.75</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">2</td>
<td align="left">2</td>
<td align="left">3</td>
<td align="left">▁▁▅▁▁▇▁▂</td>
<td align="left">F2.0</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (show_missing_values) {
  <span class="kw">plot_labelled</span>(missing_values, item_name, wrap_at)
}</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(item_info)) {
  <span class="co"># don&#39;t show choices again, if they&#39;re basically same thing as value labels</span>
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.null</span>(item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">names</span>(<span class="kw">na.omit</span>(choices)) <span class="op">==</span><span class="st"> </span>item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">na.omit</span>(choices) <span class="op">==</span><span class="st"> </span><span class="kw">names</span>(item_info<span class="op">$</span>choices))) {
    item_info<span class="op">$</span>choices &lt;-<span class="st"> </span><span class="ot">NULL</span>
  }
  item_info<span class="op">$</span>label_parsed &lt;-<span class="st"> </span>
<span class="st">    </span>item_info<span class="op">$</span>choice_list &lt;-<span class="st"> </span>item_info<span class="op">$</span>study_id &lt;-<span class="st"> </span>item_info<span class="op">$</span>id &lt;-<span class="st"> </span><span class="ot">NULL</span>
  pander<span class="op">::</span><span class="kw">pander</span>(item_info)
}</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span>) {
    pander<span class="op">::</span><span class="kw">pander</span>(<span class="kw">as.list</span>(choices))
}</code></pre>
</div>
</div>
<div id="pre_test" class="section level3 tabset">
<h3><span class="header-section-number">2.2.8</span> pre_test</h3>
<p>pre_test</p>
<div id="pre_test_distribution" class="section level4">
<h4><span class="header-section-number">2.2.8.1</span> Distribution</h4>
<pre class="sourceCode r"><code class="sourceCode r">show_missing_values &lt;-<span class="st"> </span><span class="ot">FALSE</span>
<span class="cf">if</span> (<span class="kw">has_labels</span>(item)) {
  missing_values &lt;-<span class="st"> </span>item[<span class="kw">is.na</span>(haven<span class="op">::</span><span class="kw">zap_missing</span>(item))]
  <span class="kw">attributes</span>(missing_values) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)) {
    <span class="kw">attributes</span>(missing_values)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(missing_values)<span class="op">$</span>labels[<span class="kw">is.na</span>(<span class="kw">attributes</span>(missing_values)<span class="op">$</span>labels)]
    <span class="kw">attributes</span>(item)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)<span class="op">$</span>labels[<span class="op">!</span><span class="kw">is.na</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)]
  }
  <span class="cf">if</span> (<span class="kw">is.double</span>(item)) {
    show_missing_values &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(haven<span class="op">::</span><span class="kw">na_tag</span>(missing_values))) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_missing</span>(item)
  }
  <span class="cf">if</span> (<span class="kw">length</span>(item_attributes<span class="op">$</span>labels) <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.numeric</span>(item)) {
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_labels</span>(item)
  }
}
item_nomiss &lt;-<span class="st"> </span>item[<span class="op">!</span><span class="kw">is.na</span>(item)]

<span class="co"># unnest mc_multiple and so on</span>
<span class="cf">if</span> (
  <span class="kw">is.character</span>(item_nomiss) <span class="op">&amp;&amp;</span>
<span class="st">  </span><span class="kw">any</span>(stringr<span class="op">::</span><span class="kw">str_detect</span>(item_nomiss, stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>))) <span class="op">&amp;&amp;</span>
<span class="st">  </span><span class="op">!</span><span class="kw">is.null</span>(item_info) <span class="op">&amp;&amp;</span>
<span class="st">  </span>(<span class="kw">exists</span>(<span class="st">&quot;type&quot;</span>, item_info) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span><span class="kw">any</span>(stringr<span class="op">::</span><span class="kw">str_detect</span>(item_info<span class="op">$</span>type, 
                            <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;multiple&quot;</span>))))
  ) {
  item_nomiss &lt;-<span class="st"> </span><span class="kw">unlist</span>(stringr<span class="op">::</span><span class="kw">str_split</span>(item_nomiss, <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>)))
}
<span class="kw">attributes</span>(item_nomiss) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)

old_height &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.height&quot;</span>)
non_missing_choices &lt;-<span class="st"> </span>item_attributes[[<span class="st">&quot;labels&quot;</span>]]
many_labels &lt;-<span class="st"> </span><span class="kw">length</span>(non_missing_choices) <span class="op">&gt;</span><span class="st"> </span><span class="dv">7</span>
go_vertical &lt;-<span class="st"> </span><span class="op">!</span><span class="kw">is_numeric_or_time_var</span>(item_nomiss) <span class="op">||</span><span class="st"> </span>many_labels
  
<span class="cf">if</span> ( go_vertical ) {
  <span class="co"># numeric items are plotted horizontally (because that&#39;s what usually expected)</span>
  <span class="co"># categorical items are plotted vertically because we can use the screen real estate better this way</span>

    <span class="cf">if</span> (<span class="kw">is.null</span>(choices) <span class="op">||</span><span class="st"> </span>
<span class="st">        </span>dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss) <span class="op">&gt;</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)) {
        non_missing_choices &lt;-<span class="st"> </span><span class="kw">unique</span>(item_nomiss)
        <span class="kw">names</span>(non_missing_choices) &lt;-<span class="st"> </span>non_missing_choices
    }
  choice_multiplier &lt;-<span class="st"> </span>old_height<span class="op">/</span><span class="fl">6.5</span>
    new_height &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>choice_multiplier <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&gt;</span><span class="st"> </span><span class="dv">20</span>, <span class="dv">20</span>, new_height)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">1</span>, new_height)
    <span class="cf">if</span>(<span class="kw">could_disclose_unique_values</span>(item_nomiss) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.character</span>(item_nomiss)) {
      new_height &lt;-<span class="st"> </span>old_height
    }
    knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> new_height)
}

wrap_at &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.width&quot;</span>) <span class="op">*</span><span class="st"> </span><span class="dv">10</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># todo: if there are free-text choices mingled in with the pre-defined ones, don&#39;t show</span>
<span class="co"># todo: show rare items if they are pre-defined</span>
<span class="co"># todo: bin rare responses into &quot;other category&quot;</span>
<span class="cf">if</span> (<span class="op">!</span><span class="kw">length</span>(item_nomiss)) {
  <span class="kw">cat</span>(<span class="st">&quot;No non-missing values to show.&quot;</span>)
} <span class="cf">else</span> <span class="cf">if</span> (<span class="op">!</span><span class="kw">could_disclose_unique_values</span>(item_nomiss)) {
  <span class="kw">plot_labelled</span>(item_nomiss, item_name, wrap_at, go_vertical)
} <span class="cf">else</span> {
  <span class="cf">if</span> (<span class="kw">is.character</span>(item_nomiss)) {
      char_count &lt;-<span class="st"> </span>stringr<span class="op">::</span><span class="kw">str_count</span>(item_nomiss)
      <span class="kw">attributes</span>(char_count)<span class="op">$</span>label &lt;-<span class="st"> </span>item_label
      <span class="kw">plot_labelled</span>(char_count, 
                    item_name, wrap_at, <span class="ot">FALSE</span>, <span class="dt">trans =</span> <span class="st">&quot;log1p&quot;</span>, <span class="st">&quot;characters&quot;</span>)
  } <span class="cf">else</span> {
      <span class="kw">cat</span>(dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss), <span class="st">&quot; unique, categorical values, so not shown.&quot;</span>)
  }
}</code></pre>
<p><img src="_main_files/figure-html/pre_test_distribution-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> old_height)</code></pre>
<p>79 missing values.</p>
</div>
<div id="pre_test_summary" class="section level4">
<h4><span class="header-section-number">2.2.8.2</span> Summary statistics</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attributes</span>(item) &lt;-<span class="st"> </span>item_attributes
df =<span class="st"> </span><span class="kw">data.frame</span>(item, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
<span class="kw">names</span>(df) =<span class="st"> </span>html_item_name
<span class="kw">escaped_table</span>(<span class="kw">codebook_table</span>(df))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">name</th>
<th align="left">label</th>
<th align="left">data_type</th>
<th align="left">missing</th>
<th align="left">complete</th>
<th align="left">n</th>
<th align="left">mean</th>
<th align="left">sd</th>
<th align="left">p0</th>
<th align="left">p25</th>
<th align="left">p50</th>
<th align="left">p75</th>
<th align="left">p100</th>
<th align="left">hist</th>
<th align="left">format.spss</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">pre_test</td>
<td align="left">pre_test</td>
<td align="left">numeric</td>
<td align="left">79</td>
<td align="left">328</td>
<td align="left">407</td>
<td align="left">6.02</td>
<td align="left">3.62</td>
<td align="left">0</td>
<td align="left">4</td>
<td align="left">6</td>
<td align="left">9</td>
<td align="left">16</td>
<td align="left">▆▃▇▆▅▃▁▁</td>
<td align="left">F2.0</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (show_missing_values) {
  <span class="kw">plot_labelled</span>(missing_values, item_name, wrap_at)
}</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(item_info)) {
  <span class="co"># don&#39;t show choices again, if they&#39;re basically same thing as value labels</span>
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.null</span>(item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">names</span>(<span class="kw">na.omit</span>(choices)) <span class="op">==</span><span class="st"> </span>item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">na.omit</span>(choices) <span class="op">==</span><span class="st"> </span><span class="kw">names</span>(item_info<span class="op">$</span>choices))) {
    item_info<span class="op">$</span>choices &lt;-<span class="st"> </span><span class="ot">NULL</span>
  }
  item_info<span class="op">$</span>label_parsed &lt;-<span class="st"> </span>
<span class="st">    </span>item_info<span class="op">$</span>choice_list &lt;-<span class="st"> </span>item_info<span class="op">$</span>study_id &lt;-<span class="st"> </span>item_info<span class="op">$</span>id &lt;-<span class="st"> </span><span class="ot">NULL</span>
  pander<span class="op">::</span><span class="kw">pander</span>(item_info)
}</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span>) {
    pander<span class="op">::</span><span class="kw">pander</span>(<span class="kw">as.list</span>(choices))
}</code></pre>
</div>
</div>
<div id="post_test" class="section level3 tabset">
<h3><span class="header-section-number">2.2.9</span> post_test</h3>
<p>post_test</p>
<div id="post_test_distribution" class="section level4">
<h4><span class="header-section-number">2.2.9.1</span> Distribution</h4>
<pre class="sourceCode r"><code class="sourceCode r">show_missing_values &lt;-<span class="st"> </span><span class="ot">FALSE</span>
<span class="cf">if</span> (<span class="kw">has_labels</span>(item)) {
  missing_values &lt;-<span class="st"> </span>item[<span class="kw">is.na</span>(haven<span class="op">::</span><span class="kw">zap_missing</span>(item))]
  <span class="kw">attributes</span>(missing_values) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)) {
    <span class="kw">attributes</span>(missing_values)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(missing_values)<span class="op">$</span>labels[<span class="kw">is.na</span>(<span class="kw">attributes</span>(missing_values)<span class="op">$</span>labels)]
    <span class="kw">attributes</span>(item)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)<span class="op">$</span>labels[<span class="op">!</span><span class="kw">is.na</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)]
  }
  <span class="cf">if</span> (<span class="kw">is.double</span>(item)) {
    show_missing_values &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(haven<span class="op">::</span><span class="kw">na_tag</span>(missing_values))) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_missing</span>(item)
  }
  <span class="cf">if</span> (<span class="kw">length</span>(item_attributes<span class="op">$</span>labels) <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.numeric</span>(item)) {
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_labels</span>(item)
  }
}
item_nomiss &lt;-<span class="st"> </span>item[<span class="op">!</span><span class="kw">is.na</span>(item)]

<span class="co"># unnest mc_multiple and so on</span>
<span class="cf">if</span> (
  <span class="kw">is.character</span>(item_nomiss) <span class="op">&amp;&amp;</span>
<span class="st">  </span><span class="kw">any</span>(stringr<span class="op">::</span><span class="kw">str_detect</span>(item_nomiss, stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>))) <span class="op">&amp;&amp;</span>
<span class="st">  </span><span class="op">!</span><span class="kw">is.null</span>(item_info) <span class="op">&amp;&amp;</span>
<span class="st">  </span>(<span class="kw">exists</span>(<span class="st">&quot;type&quot;</span>, item_info) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span><span class="kw">any</span>(stringr<span class="op">::</span><span class="kw">str_detect</span>(item_info<span class="op">$</span>type, 
                            <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;multiple&quot;</span>))))
  ) {
  item_nomiss &lt;-<span class="st"> </span><span class="kw">unlist</span>(stringr<span class="op">::</span><span class="kw">str_split</span>(item_nomiss, <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>)))
}
<span class="kw">attributes</span>(item_nomiss) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)

old_height &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.height&quot;</span>)
non_missing_choices &lt;-<span class="st"> </span>item_attributes[[<span class="st">&quot;labels&quot;</span>]]
many_labels &lt;-<span class="st"> </span><span class="kw">length</span>(non_missing_choices) <span class="op">&gt;</span><span class="st"> </span><span class="dv">7</span>
go_vertical &lt;-<span class="st"> </span><span class="op">!</span><span class="kw">is_numeric_or_time_var</span>(item_nomiss) <span class="op">||</span><span class="st"> </span>many_labels
  
<span class="cf">if</span> ( go_vertical ) {
  <span class="co"># numeric items are plotted horizontally (because that&#39;s what usually expected)</span>
  <span class="co"># categorical items are plotted vertically because we can use the screen real estate better this way</span>

    <span class="cf">if</span> (<span class="kw">is.null</span>(choices) <span class="op">||</span><span class="st"> </span>
<span class="st">        </span>dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss) <span class="op">&gt;</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)) {
        non_missing_choices &lt;-<span class="st"> </span><span class="kw">unique</span>(item_nomiss)
        <span class="kw">names</span>(non_missing_choices) &lt;-<span class="st"> </span>non_missing_choices
    }
  choice_multiplier &lt;-<span class="st"> </span>old_height<span class="op">/</span><span class="fl">6.5</span>
    new_height &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>choice_multiplier <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&gt;</span><span class="st"> </span><span class="dv">20</span>, <span class="dv">20</span>, new_height)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">1</span>, new_height)
    <span class="cf">if</span>(<span class="kw">could_disclose_unique_values</span>(item_nomiss) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.character</span>(item_nomiss)) {
      new_height &lt;-<span class="st"> </span>old_height
    }
    knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> new_height)
}

wrap_at &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.width&quot;</span>) <span class="op">*</span><span class="st"> </span><span class="dv">10</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># todo: if there are free-text choices mingled in with the pre-defined ones, don&#39;t show</span>
<span class="co"># todo: show rare items if they are pre-defined</span>
<span class="co"># todo: bin rare responses into &quot;other category&quot;</span>
<span class="cf">if</span> (<span class="op">!</span><span class="kw">length</span>(item_nomiss)) {
  <span class="kw">cat</span>(<span class="st">&quot;No non-missing values to show.&quot;</span>)
} <span class="cf">else</span> <span class="cf">if</span> (<span class="op">!</span><span class="kw">could_disclose_unique_values</span>(item_nomiss)) {
  <span class="kw">plot_labelled</span>(item_nomiss, item_name, wrap_at, go_vertical)
} <span class="cf">else</span> {
  <span class="cf">if</span> (<span class="kw">is.character</span>(item_nomiss)) {
      char_count &lt;-<span class="st"> </span>stringr<span class="op">::</span><span class="kw">str_count</span>(item_nomiss)
      <span class="kw">attributes</span>(char_count)<span class="op">$</span>label &lt;-<span class="st"> </span>item_label
      <span class="kw">plot_labelled</span>(char_count, 
                    item_name, wrap_at, <span class="ot">FALSE</span>, <span class="dt">trans =</span> <span class="st">&quot;log1p&quot;</span>, <span class="st">&quot;characters&quot;</span>)
  } <span class="cf">else</span> {
      <span class="kw">cat</span>(dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss), <span class="st">&quot; unique, categorical values, so not shown.&quot;</span>)
  }
}</code></pre>
<p><img src="_main_files/figure-html/post_test_distribution-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> old_height)</code></pre>
<p>81 missing values.</p>
</div>
<div id="post_test_summary" class="section level4">
<h4><span class="header-section-number">2.2.9.2</span> Summary statistics</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attributes</span>(item) &lt;-<span class="st"> </span>item_attributes
df =<span class="st"> </span><span class="kw">data.frame</span>(item, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
<span class="kw">names</span>(df) =<span class="st"> </span>html_item_name
<span class="kw">escaped_table</span>(<span class="kw">codebook_table</span>(df))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">name</th>
<th align="left">label</th>
<th align="left">data_type</th>
<th align="left">missing</th>
<th align="left">complete</th>
<th align="left">n</th>
<th align="left">mean</th>
<th align="left">sd</th>
<th align="left">p0</th>
<th align="left">p25</th>
<th align="left">p50</th>
<th align="left">p75</th>
<th align="left">p100</th>
<th align="left">hist</th>
<th align="left">format.spss</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">post_test</td>
<td align="left">post_test</td>
<td align="left">numeric</td>
<td align="left">81</td>
<td align="left">326</td>
<td align="left">407</td>
<td align="left">8.6</td>
<td align="left">3.56</td>
<td align="left">0</td>
<td align="left">6</td>
<td align="left">9</td>
<td align="left">11</td>
<td align="left">15</td>
<td align="left">▂▂▅▆▆▇▆▃</td>
<td align="left">F2.0</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (show_missing_values) {
  <span class="kw">plot_labelled</span>(missing_values, item_name, wrap_at)
}</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(item_info)) {
  <span class="co"># don&#39;t show choices again, if they&#39;re basically same thing as value labels</span>
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.null</span>(item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">names</span>(<span class="kw">na.omit</span>(choices)) <span class="op">==</span><span class="st"> </span>item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">na.omit</span>(choices) <span class="op">==</span><span class="st"> </span><span class="kw">names</span>(item_info<span class="op">$</span>choices))) {
    item_info<span class="op">$</span>choices &lt;-<span class="st"> </span><span class="ot">NULL</span>
  }
  item_info<span class="op">$</span>label_parsed &lt;-<span class="st"> </span>
<span class="st">    </span>item_info<span class="op">$</span>choice_list &lt;-<span class="st"> </span>item_info<span class="op">$</span>study_id &lt;-<span class="st"> </span>item_info<span class="op">$</span>id &lt;-<span class="st"> </span><span class="ot">NULL</span>
  pander<span class="op">::</span><span class="kw">pander</span>(item_info)
}</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span>) {
    pander<span class="op">::</span><span class="kw">pander</span>(<span class="kw">as.list</span>(choices))
}</code></pre>
</div>
</div>
<div id="ccprod1" class="section level3 tabset">
<h3><span class="header-section-number">2.2.10</span> ccprod1</h3>
<p>productivity, pretest</p>
<div id="ccprod1_distribution" class="section level4">
<h4><span class="header-section-number">2.2.10.1</span> Distribution</h4>
<pre class="sourceCode r"><code class="sourceCode r">show_missing_values &lt;-<span class="st"> </span><span class="ot">FALSE</span>
<span class="cf">if</span> (<span class="kw">has_labels</span>(item)) {
  missing_values &lt;-<span class="st"> </span>item[<span class="kw">is.na</span>(haven<span class="op">::</span><span class="kw">zap_missing</span>(item))]
  <span class="kw">attributes</span>(missing_values) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)) {
    <span class="kw">attributes</span>(missing_values)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(missing_values)<span class="op">$</span>labels[<span class="kw">is.na</span>(<span class="kw">attributes</span>(missing_values)<span class="op">$</span>labels)]
    <span class="kw">attributes</span>(item)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)<span class="op">$</span>labels[<span class="op">!</span><span class="kw">is.na</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)]
  }
  <span class="cf">if</span> (<span class="kw">is.double</span>(item)) {
    show_missing_values &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(haven<span class="op">::</span><span class="kw">na_tag</span>(missing_values))) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_missing</span>(item)
  }
  <span class="cf">if</span> (<span class="kw">length</span>(item_attributes<span class="op">$</span>labels) <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.numeric</span>(item)) {
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_labels</span>(item)
  }
}
item_nomiss &lt;-<span class="st"> </span>item[<span class="op">!</span><span class="kw">is.na</span>(item)]

<span class="co"># unnest mc_multiple and so on</span>
<span class="cf">if</span> (
  <span class="kw">is.character</span>(item_nomiss) <span class="op">&amp;&amp;</span>
<span class="st">  </span><span class="kw">any</span>(stringr<span class="op">::</span><span class="kw">str_detect</span>(item_nomiss, stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>))) <span class="op">&amp;&amp;</span>
<span class="st">  </span><span class="op">!</span><span class="kw">is.null</span>(item_info) <span class="op">&amp;&amp;</span>
<span class="st">  </span>(<span class="kw">exists</span>(<span class="st">&quot;type&quot;</span>, item_info) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span><span class="kw">any</span>(stringr<span class="op">::</span><span class="kw">str_detect</span>(item_info<span class="op">$</span>type, 
                            <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;multiple&quot;</span>))))
  ) {
  item_nomiss &lt;-<span class="st"> </span><span class="kw">unlist</span>(stringr<span class="op">::</span><span class="kw">str_split</span>(item_nomiss, <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>)))
}
<span class="kw">attributes</span>(item_nomiss) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)

old_height &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.height&quot;</span>)
non_missing_choices &lt;-<span class="st"> </span>item_attributes[[<span class="st">&quot;labels&quot;</span>]]
many_labels &lt;-<span class="st"> </span><span class="kw">length</span>(non_missing_choices) <span class="op">&gt;</span><span class="st"> </span><span class="dv">7</span>
go_vertical &lt;-<span class="st"> </span><span class="op">!</span><span class="kw">is_numeric_or_time_var</span>(item_nomiss) <span class="op">||</span><span class="st"> </span>many_labels
  
<span class="cf">if</span> ( go_vertical ) {
  <span class="co"># numeric items are plotted horizontally (because that&#39;s what usually expected)</span>
  <span class="co"># categorical items are plotted vertically because we can use the screen real estate better this way</span>

    <span class="cf">if</span> (<span class="kw">is.null</span>(choices) <span class="op">||</span><span class="st"> </span>
<span class="st">        </span>dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss) <span class="op">&gt;</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)) {
        non_missing_choices &lt;-<span class="st"> </span><span class="kw">unique</span>(item_nomiss)
        <span class="kw">names</span>(non_missing_choices) &lt;-<span class="st"> </span>non_missing_choices
    }
  choice_multiplier &lt;-<span class="st"> </span>old_height<span class="op">/</span><span class="fl">6.5</span>
    new_height &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>choice_multiplier <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&gt;</span><span class="st"> </span><span class="dv">20</span>, <span class="dv">20</span>, new_height)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">1</span>, new_height)
    <span class="cf">if</span>(<span class="kw">could_disclose_unique_values</span>(item_nomiss) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.character</span>(item_nomiss)) {
      new_height &lt;-<span class="st"> </span>old_height
    }
    knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> new_height)
}

wrap_at &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.width&quot;</span>) <span class="op">*</span><span class="st"> </span><span class="dv">10</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># todo: if there are free-text choices mingled in with the pre-defined ones, don&#39;t show</span>
<span class="co"># todo: show rare items if they are pre-defined</span>
<span class="co"># todo: bin rare responses into &quot;other category&quot;</span>
<span class="cf">if</span> (<span class="op">!</span><span class="kw">length</span>(item_nomiss)) {
  <span class="kw">cat</span>(<span class="st">&quot;No non-missing values to show.&quot;</span>)
} <span class="cf">else</span> <span class="cf">if</span> (<span class="op">!</span><span class="kw">could_disclose_unique_values</span>(item_nomiss)) {
  <span class="kw">plot_labelled</span>(item_nomiss, item_name, wrap_at, go_vertical)
} <span class="cf">else</span> {
  <span class="cf">if</span> (<span class="kw">is.character</span>(item_nomiss)) {
      char_count &lt;-<span class="st"> </span>stringr<span class="op">::</span><span class="kw">str_count</span>(item_nomiss)
      <span class="kw">attributes</span>(char_count)<span class="op">$</span>label &lt;-<span class="st"> </span>item_label
      <span class="kw">plot_labelled</span>(char_count, 
                    item_name, wrap_at, <span class="ot">FALSE</span>, <span class="dt">trans =</span> <span class="st">&quot;log1p&quot;</span>, <span class="st">&quot;characters&quot;</span>)
  } <span class="cf">else</span> {
      <span class="kw">cat</span>(dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss), <span class="st">&quot; unique, categorical values, so not shown.&quot;</span>)
  }
}</code></pre>
<p><img src="_main_files/figure-html/ccprod1_distribution-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> old_height)</code></pre>
<p>79 missing values.</p>
</div>
<div id="ccprod1_summary" class="section level4">
<h4><span class="header-section-number">2.2.10.2</span> Summary statistics</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attributes</span>(item) &lt;-<span class="st"> </span>item_attributes
df =<span class="st"> </span><span class="kw">data.frame</span>(item, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
<span class="kw">names</span>(df) =<span class="st"> </span>html_item_name
<span class="kw">escaped_table</span>(<span class="kw">codebook_table</span>(df))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">name</th>
<th align="left">label</th>
<th align="left">data_type</th>
<th align="left">missing</th>
<th align="left">complete</th>
<th align="left">n</th>
<th align="left">mean</th>
<th align="left">sd</th>
<th align="left">p0</th>
<th align="left">p25</th>
<th align="left">p50</th>
<th align="left">p75</th>
<th align="left">p100</th>
<th align="left">hist</th>
<th align="left">format.spss</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ccprod1</td>
<td align="left">productivity, pretest</td>
<td align="left">numeric</td>
<td align="left">79</td>
<td align="left">328</td>
<td align="left">407</td>
<td align="left">3.92</td>
<td align="left">3.22</td>
<td align="left">0</td>
<td align="left">2</td>
<td align="left">4</td>
<td align="left">6</td>
<td align="left">17</td>
<td align="left">▇▅▃▂▂▁▁▁</td>
<td align="left">F2.0</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (show_missing_values) {
  <span class="kw">plot_labelled</span>(missing_values, item_name, wrap_at)
}</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(item_info)) {
  <span class="co"># don&#39;t show choices again, if they&#39;re basically same thing as value labels</span>
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.null</span>(item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">names</span>(<span class="kw">na.omit</span>(choices)) <span class="op">==</span><span class="st"> </span>item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">na.omit</span>(choices) <span class="op">==</span><span class="st"> </span><span class="kw">names</span>(item_info<span class="op">$</span>choices))) {
    item_info<span class="op">$</span>choices &lt;-<span class="st"> </span><span class="ot">NULL</span>
  }
  item_info<span class="op">$</span>label_parsed &lt;-<span class="st"> </span>
<span class="st">    </span>item_info<span class="op">$</span>choice_list &lt;-<span class="st"> </span>item_info<span class="op">$</span>study_id &lt;-<span class="st"> </span>item_info<span class="op">$</span>id &lt;-<span class="st"> </span><span class="ot">NULL</span>
  pander<span class="op">::</span><span class="kw">pander</span>(item_info)
}</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span>) {
    pander<span class="op">::</span><span class="kw">pander</span>(<span class="kw">as.list</span>(choices))
}</code></pre>
</div>
</div>
<div id="ccprod2" class="section level3 tabset">
<h3><span class="header-section-number">2.2.11</span> ccprod2</h3>
<p>productivity, posttest</p>
<div id="ccprod2_distribution" class="section level4">
<h4><span class="header-section-number">2.2.11.1</span> Distribution</h4>
<pre class="sourceCode r"><code class="sourceCode r">show_missing_values &lt;-<span class="st"> </span><span class="ot">FALSE</span>
<span class="cf">if</span> (<span class="kw">has_labels</span>(item)) {
  missing_values &lt;-<span class="st"> </span>item[<span class="kw">is.na</span>(haven<span class="op">::</span><span class="kw">zap_missing</span>(item))]
  <span class="kw">attributes</span>(missing_values) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)) {
    <span class="kw">attributes</span>(missing_values)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(missing_values)<span class="op">$</span>labels[<span class="kw">is.na</span>(<span class="kw">attributes</span>(missing_values)<span class="op">$</span>labels)]
    <span class="kw">attributes</span>(item)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)<span class="op">$</span>labels[<span class="op">!</span><span class="kw">is.na</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)]
  }
  <span class="cf">if</span> (<span class="kw">is.double</span>(item)) {
    show_missing_values &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(haven<span class="op">::</span><span class="kw">na_tag</span>(missing_values))) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_missing</span>(item)
  }
  <span class="cf">if</span> (<span class="kw">length</span>(item_attributes<span class="op">$</span>labels) <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.numeric</span>(item)) {
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_labels</span>(item)
  }
}
item_nomiss &lt;-<span class="st"> </span>item[<span class="op">!</span><span class="kw">is.na</span>(item)]

<span class="co"># unnest mc_multiple and so on</span>
<span class="cf">if</span> (
  <span class="kw">is.character</span>(item_nomiss) <span class="op">&amp;&amp;</span>
<span class="st">  </span><span class="kw">any</span>(stringr<span class="op">::</span><span class="kw">str_detect</span>(item_nomiss, stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>))) <span class="op">&amp;&amp;</span>
<span class="st">  </span><span class="op">!</span><span class="kw">is.null</span>(item_info) <span class="op">&amp;&amp;</span>
<span class="st">  </span>(<span class="kw">exists</span>(<span class="st">&quot;type&quot;</span>, item_info) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span><span class="kw">any</span>(stringr<span class="op">::</span><span class="kw">str_detect</span>(item_info<span class="op">$</span>type, 
                            <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;multiple&quot;</span>))))
  ) {
  item_nomiss &lt;-<span class="st"> </span><span class="kw">unlist</span>(stringr<span class="op">::</span><span class="kw">str_split</span>(item_nomiss, <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>)))
}
<span class="kw">attributes</span>(item_nomiss) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)

old_height &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.height&quot;</span>)
non_missing_choices &lt;-<span class="st"> </span>item_attributes[[<span class="st">&quot;labels&quot;</span>]]
many_labels &lt;-<span class="st"> </span><span class="kw">length</span>(non_missing_choices) <span class="op">&gt;</span><span class="st"> </span><span class="dv">7</span>
go_vertical &lt;-<span class="st"> </span><span class="op">!</span><span class="kw">is_numeric_or_time_var</span>(item_nomiss) <span class="op">||</span><span class="st"> </span>many_labels
  
<span class="cf">if</span> ( go_vertical ) {
  <span class="co"># numeric items are plotted horizontally (because that&#39;s what usually expected)</span>
  <span class="co"># categorical items are plotted vertically because we can use the screen real estate better this way</span>

    <span class="cf">if</span> (<span class="kw">is.null</span>(choices) <span class="op">||</span><span class="st"> </span>
<span class="st">        </span>dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss) <span class="op">&gt;</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)) {
        non_missing_choices &lt;-<span class="st"> </span><span class="kw">unique</span>(item_nomiss)
        <span class="kw">names</span>(non_missing_choices) &lt;-<span class="st"> </span>non_missing_choices
    }
  choice_multiplier &lt;-<span class="st"> </span>old_height<span class="op">/</span><span class="fl">6.5</span>
    new_height &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>choice_multiplier <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&gt;</span><span class="st"> </span><span class="dv">20</span>, <span class="dv">20</span>, new_height)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">1</span>, new_height)
    <span class="cf">if</span>(<span class="kw">could_disclose_unique_values</span>(item_nomiss) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.character</span>(item_nomiss)) {
      new_height &lt;-<span class="st"> </span>old_height
    }
    knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> new_height)
}

wrap_at &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.width&quot;</span>) <span class="op">*</span><span class="st"> </span><span class="dv">10</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># todo: if there are free-text choices mingled in with the pre-defined ones, don&#39;t show</span>
<span class="co"># todo: show rare items if they are pre-defined</span>
<span class="co"># todo: bin rare responses into &quot;other category&quot;</span>
<span class="cf">if</span> (<span class="op">!</span><span class="kw">length</span>(item_nomiss)) {
  <span class="kw">cat</span>(<span class="st">&quot;No non-missing values to show.&quot;</span>)
} <span class="cf">else</span> <span class="cf">if</span> (<span class="op">!</span><span class="kw">could_disclose_unique_values</span>(item_nomiss)) {
  <span class="kw">plot_labelled</span>(item_nomiss, item_name, wrap_at, go_vertical)
} <span class="cf">else</span> {
  <span class="cf">if</span> (<span class="kw">is.character</span>(item_nomiss)) {
      char_count &lt;-<span class="st"> </span>stringr<span class="op">::</span><span class="kw">str_count</span>(item_nomiss)
      <span class="kw">attributes</span>(char_count)<span class="op">$</span>label &lt;-<span class="st"> </span>item_label
      <span class="kw">plot_labelled</span>(char_count, 
                    item_name, wrap_at, <span class="ot">FALSE</span>, <span class="dt">trans =</span> <span class="st">&quot;log1p&quot;</span>, <span class="st">&quot;characters&quot;</span>)
  } <span class="cf">else</span> {
      <span class="kw">cat</span>(dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss), <span class="st">&quot; unique, categorical values, so not shown.&quot;</span>)
  }
}</code></pre>
<p><img src="_main_files/figure-html/ccprod2_distribution-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> old_height)</code></pre>
<p>81 missing values.</p>
</div>
<div id="ccprod2_summary" class="section level4">
<h4><span class="header-section-number">2.2.11.2</span> Summary statistics</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attributes</span>(item) &lt;-<span class="st"> </span>item_attributes
df =<span class="st"> </span><span class="kw">data.frame</span>(item, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
<span class="kw">names</span>(df) =<span class="st"> </span>html_item_name
<span class="kw">escaped_table</span>(<span class="kw">codebook_table</span>(df))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">name</th>
<th align="left">label</th>
<th align="left">data_type</th>
<th align="left">missing</th>
<th align="left">complete</th>
<th align="left">n</th>
<th align="left">mean</th>
<th align="left">sd</th>
<th align="left">p0</th>
<th align="left">p25</th>
<th align="left">p50</th>
<th align="left">p75</th>
<th align="left">p100</th>
<th align="left">hist</th>
<th align="left">format.spss</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ccprod2</td>
<td align="left">productivity, posttest</td>
<td align="left">numeric</td>
<td align="left">81</td>
<td align="left">326</td>
<td align="left">407</td>
<td align="left">4.91</td>
<td align="left">2.98</td>
<td align="left">0</td>
<td align="left">3</td>
<td align="left">5</td>
<td align="left">7</td>
<td align="left">19</td>
<td align="left">▅▆▇▂▁▁▁▁</td>
<td align="left">F2.0</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (show_missing_values) {
  <span class="kw">plot_labelled</span>(missing_values, item_name, wrap_at)
}</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(item_info)) {
  <span class="co"># don&#39;t show choices again, if they&#39;re basically same thing as value labels</span>
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.null</span>(item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">names</span>(<span class="kw">na.omit</span>(choices)) <span class="op">==</span><span class="st"> </span>item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">na.omit</span>(choices) <span class="op">==</span><span class="st"> </span><span class="kw">names</span>(item_info<span class="op">$</span>choices))) {
    item_info<span class="op">$</span>choices &lt;-<span class="st"> </span><span class="ot">NULL</span>
  }
  item_info<span class="op">$</span>label_parsed &lt;-<span class="st"> </span>
<span class="st">    </span>item_info<span class="op">$</span>choice_list &lt;-<span class="st"> </span>item_info<span class="op">$</span>study_id &lt;-<span class="st"> </span>item_info<span class="op">$</span>id &lt;-<span class="st"> </span><span class="ot">NULL</span>
  pander<span class="op">::</span><span class="kw">pander</span>(item_info)
}</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span>) {
    pander<span class="op">::</span><span class="kw">pander</span>(<span class="kw">as.list</span>(choices))
}</code></pre>
</div>
</div>
<div id="ccrdr1" class="section level3 tabset">
<h3><span class="header-section-number">2.2.12</span> ccrdr1</h3>
<ol start="18" style="list-style-type: lower-alpha">
<li>sensitivity, pretest</li>
</ol>
<div id="ccrdr1_distribution" class="section level4">
<h4><span class="header-section-number">2.2.12.1</span> Distribution</h4>
<pre class="sourceCode r"><code class="sourceCode r">show_missing_values &lt;-<span class="st"> </span><span class="ot">FALSE</span>
<span class="cf">if</span> (<span class="kw">has_labels</span>(item)) {
  missing_values &lt;-<span class="st"> </span>item[<span class="kw">is.na</span>(haven<span class="op">::</span><span class="kw">zap_missing</span>(item))]
  <span class="kw">attributes</span>(missing_values) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)) {
    <span class="kw">attributes</span>(missing_values)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(missing_values)<span class="op">$</span>labels[<span class="kw">is.na</span>(<span class="kw">attributes</span>(missing_values)<span class="op">$</span>labels)]
    <span class="kw">attributes</span>(item)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)<span class="op">$</span>labels[<span class="op">!</span><span class="kw">is.na</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)]
  }
  <span class="cf">if</span> (<span class="kw">is.double</span>(item)) {
    show_missing_values &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(haven<span class="op">::</span><span class="kw">na_tag</span>(missing_values))) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_missing</span>(item)
  }
  <span class="cf">if</span> (<span class="kw">length</span>(item_attributes<span class="op">$</span>labels) <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.numeric</span>(item)) {
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_labels</span>(item)
  }
}
item_nomiss &lt;-<span class="st"> </span>item[<span class="op">!</span><span class="kw">is.na</span>(item)]

<span class="co"># unnest mc_multiple and so on</span>
<span class="cf">if</span> (
  <span class="kw">is.character</span>(item_nomiss) <span class="op">&amp;&amp;</span>
<span class="st">  </span><span class="kw">any</span>(stringr<span class="op">::</span><span class="kw">str_detect</span>(item_nomiss, stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>))) <span class="op">&amp;&amp;</span>
<span class="st">  </span><span class="op">!</span><span class="kw">is.null</span>(item_info) <span class="op">&amp;&amp;</span>
<span class="st">  </span>(<span class="kw">exists</span>(<span class="st">&quot;type&quot;</span>, item_info) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span><span class="kw">any</span>(stringr<span class="op">::</span><span class="kw">str_detect</span>(item_info<span class="op">$</span>type, 
                            <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;multiple&quot;</span>))))
  ) {
  item_nomiss &lt;-<span class="st"> </span><span class="kw">unlist</span>(stringr<span class="op">::</span><span class="kw">str_split</span>(item_nomiss, <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>)))
}
<span class="kw">attributes</span>(item_nomiss) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)

old_height &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.height&quot;</span>)
non_missing_choices &lt;-<span class="st"> </span>item_attributes[[<span class="st">&quot;labels&quot;</span>]]
many_labels &lt;-<span class="st"> </span><span class="kw">length</span>(non_missing_choices) <span class="op">&gt;</span><span class="st"> </span><span class="dv">7</span>
go_vertical &lt;-<span class="st"> </span><span class="op">!</span><span class="kw">is_numeric_or_time_var</span>(item_nomiss) <span class="op">||</span><span class="st"> </span>many_labels
  
<span class="cf">if</span> ( go_vertical ) {
  <span class="co"># numeric items are plotted horizontally (because that&#39;s what usually expected)</span>
  <span class="co"># categorical items are plotted vertically because we can use the screen real estate better this way</span>

    <span class="cf">if</span> (<span class="kw">is.null</span>(choices) <span class="op">||</span><span class="st"> </span>
<span class="st">        </span>dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss) <span class="op">&gt;</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)) {
        non_missing_choices &lt;-<span class="st"> </span><span class="kw">unique</span>(item_nomiss)
        <span class="kw">names</span>(non_missing_choices) &lt;-<span class="st"> </span>non_missing_choices
    }
  choice_multiplier &lt;-<span class="st"> </span>old_height<span class="op">/</span><span class="fl">6.5</span>
    new_height &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>choice_multiplier <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&gt;</span><span class="st"> </span><span class="dv">20</span>, <span class="dv">20</span>, new_height)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">1</span>, new_height)
    <span class="cf">if</span>(<span class="kw">could_disclose_unique_values</span>(item_nomiss) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.character</span>(item_nomiss)) {
      new_height &lt;-<span class="st"> </span>old_height
    }
    knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> new_height)
}

wrap_at &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.width&quot;</span>) <span class="op">*</span><span class="st"> </span><span class="dv">10</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># todo: if there are free-text choices mingled in with the pre-defined ones, don&#39;t show</span>
<span class="co"># todo: show rare items if they are pre-defined</span>
<span class="co"># todo: bin rare responses into &quot;other category&quot;</span>
<span class="cf">if</span> (<span class="op">!</span><span class="kw">length</span>(item_nomiss)) {
  <span class="kw">cat</span>(<span class="st">&quot;No non-missing values to show.&quot;</span>)
} <span class="cf">else</span> <span class="cf">if</span> (<span class="op">!</span><span class="kw">could_disclose_unique_values</span>(item_nomiss)) {
  <span class="kw">plot_labelled</span>(item_nomiss, item_name, wrap_at, go_vertical)
} <span class="cf">else</span> {
  <span class="cf">if</span> (<span class="kw">is.character</span>(item_nomiss)) {
      char_count &lt;-<span class="st"> </span>stringr<span class="op">::</span><span class="kw">str_count</span>(item_nomiss)
      <span class="kw">attributes</span>(char_count)<span class="op">$</span>label &lt;-<span class="st"> </span>item_label
      <span class="kw">plot_labelled</span>(char_count, 
                    item_name, wrap_at, <span class="ot">FALSE</span>, <span class="dt">trans =</span> <span class="st">&quot;log1p&quot;</span>, <span class="st">&quot;characters&quot;</span>)
  } <span class="cf">else</span> {
      <span class="kw">cat</span>(dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss), <span class="st">&quot; unique, categorical values, so not shown.&quot;</span>)
  }
}</code></pre>
<p><img src="_main_files/figure-html/ccrdr1_distribution-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> old_height)</code></pre>
<p>79 missing values.</p>
</div>
<div id="ccrdr1_summary" class="section level4">
<h4><span class="header-section-number">2.2.12.2</span> Summary statistics</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attributes</span>(item) &lt;-<span class="st"> </span>item_attributes
df =<span class="st"> </span><span class="kw">data.frame</span>(item, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
<span class="kw">names</span>(df) =<span class="st"> </span>html_item_name
<span class="kw">escaped_table</span>(<span class="kw">codebook_table</span>(df))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">name</th>
<th align="left">label</th>
<th align="left">data_type</th>
<th align="left">missing</th>
<th align="left">complete</th>
<th align="left">n</th>
<th align="left">mean</th>
<th align="left">sd</th>
<th align="left">p0</th>
<th align="left">p25</th>
<th align="left">p50</th>
<th align="left">p75</th>
<th align="left">p100</th>
<th align="left">hist</th>
<th align="left">format.spss</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ccrdr1</td>
<td align="left">r. sensitivity, pretest</td>
<td align="left">numeric</td>
<td align="left">79</td>
<td align="left">328</td>
<td align="left">407</td>
<td align="left">0.86</td>
<td align="left">1.33</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">8</td>
<td align="left">▇▁▁▁▁▁▁▁</td>
<td align="left">F2.0</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (show_missing_values) {
  <span class="kw">plot_labelled</span>(missing_values, item_name, wrap_at)
}</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(item_info)) {
  <span class="co"># don&#39;t show choices again, if they&#39;re basically same thing as value labels</span>
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.null</span>(item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">names</span>(<span class="kw">na.omit</span>(choices)) <span class="op">==</span><span class="st"> </span>item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">na.omit</span>(choices) <span class="op">==</span><span class="st"> </span><span class="kw">names</span>(item_info<span class="op">$</span>choices))) {
    item_info<span class="op">$</span>choices &lt;-<span class="st"> </span><span class="ot">NULL</span>
  }
  item_info<span class="op">$</span>label_parsed &lt;-<span class="st"> </span>
<span class="st">    </span>item_info<span class="op">$</span>choice_list &lt;-<span class="st"> </span>item_info<span class="op">$</span>study_id &lt;-<span class="st"> </span>item_info<span class="op">$</span>id &lt;-<span class="st"> </span><span class="ot">NULL</span>
  pander<span class="op">::</span><span class="kw">pander</span>(item_info)
}</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span>) {
    pander<span class="op">::</span><span class="kw">pander</span>(<span class="kw">as.list</span>(choices))
}</code></pre>
</div>
</div>
<div id="ccrdr2" class="section level3 tabset">
<h3><span class="header-section-number">2.2.13</span> ccrdr2</h3>
<ol start="18" style="list-style-type: lower-alpha">
<li>sensitivity, posttest</li>
</ol>
<div id="ccrdr2_distribution" class="section level4">
<h4><span class="header-section-number">2.2.13.1</span> Distribution</h4>
<pre class="sourceCode r"><code class="sourceCode r">show_missing_values &lt;-<span class="st"> </span><span class="ot">FALSE</span>
<span class="cf">if</span> (<span class="kw">has_labels</span>(item)) {
  missing_values &lt;-<span class="st"> </span>item[<span class="kw">is.na</span>(haven<span class="op">::</span><span class="kw">zap_missing</span>(item))]
  <span class="kw">attributes</span>(missing_values) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)) {
    <span class="kw">attributes</span>(missing_values)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(missing_values)<span class="op">$</span>labels[<span class="kw">is.na</span>(<span class="kw">attributes</span>(missing_values)<span class="op">$</span>labels)]
    <span class="kw">attributes</span>(item)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)<span class="op">$</span>labels[<span class="op">!</span><span class="kw">is.na</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)]
  }
  <span class="cf">if</span> (<span class="kw">is.double</span>(item)) {
    show_missing_values &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(haven<span class="op">::</span><span class="kw">na_tag</span>(missing_values))) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_missing</span>(item)
  }
  <span class="cf">if</span> (<span class="kw">length</span>(item_attributes<span class="op">$</span>labels) <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.numeric</span>(item)) {
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_labels</span>(item)
  }
}
item_nomiss &lt;-<span class="st"> </span>item[<span class="op">!</span><span class="kw">is.na</span>(item)]

<span class="co"># unnest mc_multiple and so on</span>
<span class="cf">if</span> (
  <span class="kw">is.character</span>(item_nomiss) <span class="op">&amp;&amp;</span>
<span class="st">  </span><span class="kw">any</span>(stringr<span class="op">::</span><span class="kw">str_detect</span>(item_nomiss, stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>))) <span class="op">&amp;&amp;</span>
<span class="st">  </span><span class="op">!</span><span class="kw">is.null</span>(item_info) <span class="op">&amp;&amp;</span>
<span class="st">  </span>(<span class="kw">exists</span>(<span class="st">&quot;type&quot;</span>, item_info) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span><span class="kw">any</span>(stringr<span class="op">::</span><span class="kw">str_detect</span>(item_info<span class="op">$</span>type, 
                            <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;multiple&quot;</span>))))
  ) {
  item_nomiss &lt;-<span class="st"> </span><span class="kw">unlist</span>(stringr<span class="op">::</span><span class="kw">str_split</span>(item_nomiss, <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>)))
}
<span class="kw">attributes</span>(item_nomiss) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)

old_height &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.height&quot;</span>)
non_missing_choices &lt;-<span class="st"> </span>item_attributes[[<span class="st">&quot;labels&quot;</span>]]
many_labels &lt;-<span class="st"> </span><span class="kw">length</span>(non_missing_choices) <span class="op">&gt;</span><span class="st"> </span><span class="dv">7</span>
go_vertical &lt;-<span class="st"> </span><span class="op">!</span><span class="kw">is_numeric_or_time_var</span>(item_nomiss) <span class="op">||</span><span class="st"> </span>many_labels
  
<span class="cf">if</span> ( go_vertical ) {
  <span class="co"># numeric items are plotted horizontally (because that&#39;s what usually expected)</span>
  <span class="co"># categorical items are plotted vertically because we can use the screen real estate better this way</span>

    <span class="cf">if</span> (<span class="kw">is.null</span>(choices) <span class="op">||</span><span class="st"> </span>
<span class="st">        </span>dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss) <span class="op">&gt;</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)) {
        non_missing_choices &lt;-<span class="st"> </span><span class="kw">unique</span>(item_nomiss)
        <span class="kw">names</span>(non_missing_choices) &lt;-<span class="st"> </span>non_missing_choices
    }
  choice_multiplier &lt;-<span class="st"> </span>old_height<span class="op">/</span><span class="fl">6.5</span>
    new_height &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>choice_multiplier <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&gt;</span><span class="st"> </span><span class="dv">20</span>, <span class="dv">20</span>, new_height)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">1</span>, new_height)
    <span class="cf">if</span>(<span class="kw">could_disclose_unique_values</span>(item_nomiss) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.character</span>(item_nomiss)) {
      new_height &lt;-<span class="st"> </span>old_height
    }
    knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> new_height)
}

wrap_at &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.width&quot;</span>) <span class="op">*</span><span class="st"> </span><span class="dv">10</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># todo: if there are free-text choices mingled in with the pre-defined ones, don&#39;t show</span>
<span class="co"># todo: show rare items if they are pre-defined</span>
<span class="co"># todo: bin rare responses into &quot;other category&quot;</span>
<span class="cf">if</span> (<span class="op">!</span><span class="kw">length</span>(item_nomiss)) {
  <span class="kw">cat</span>(<span class="st">&quot;No non-missing values to show.&quot;</span>)
} <span class="cf">else</span> <span class="cf">if</span> (<span class="op">!</span><span class="kw">could_disclose_unique_values</span>(item_nomiss)) {
  <span class="kw">plot_labelled</span>(item_nomiss, item_name, wrap_at, go_vertical)
} <span class="cf">else</span> {
  <span class="cf">if</span> (<span class="kw">is.character</span>(item_nomiss)) {
      char_count &lt;-<span class="st"> </span>stringr<span class="op">::</span><span class="kw">str_count</span>(item_nomiss)
      <span class="kw">attributes</span>(char_count)<span class="op">$</span>label &lt;-<span class="st"> </span>item_label
      <span class="kw">plot_labelled</span>(char_count, 
                    item_name, wrap_at, <span class="ot">FALSE</span>, <span class="dt">trans =</span> <span class="st">&quot;log1p&quot;</span>, <span class="st">&quot;characters&quot;</span>)
  } <span class="cf">else</span> {
      <span class="kw">cat</span>(dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss), <span class="st">&quot; unique, categorical values, so not shown.&quot;</span>)
  }
}</code></pre>
<p><img src="_main_files/figure-html/ccrdr2_distribution-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> old_height)</code></pre>
<p>82 missing values.</p>
</div>
<div id="ccrdr2_summary" class="section level4">
<h4><span class="header-section-number">2.2.13.2</span> Summary statistics</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attributes</span>(item) &lt;-<span class="st"> </span>item_attributes
df =<span class="st"> </span><span class="kw">data.frame</span>(item, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
<span class="kw">names</span>(df) =<span class="st"> </span>html_item_name
<span class="kw">escaped_table</span>(<span class="kw">codebook_table</span>(df))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">name</th>
<th align="left">label</th>
<th align="left">data_type</th>
<th align="left">missing</th>
<th align="left">complete</th>
<th align="left">n</th>
<th align="left">mean</th>
<th align="left">sd</th>
<th align="left">p0</th>
<th align="left">p25</th>
<th align="left">p50</th>
<th align="left">p75</th>
<th align="left">p100</th>
<th align="left">hist</th>
<th align="left">format.spss</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ccrdr2</td>
<td align="left">r. sensitivity, posttest</td>
<td align="left">numeric</td>
<td align="left">82</td>
<td align="left">325</td>
<td align="left">407</td>
<td align="left">2.48</td>
<td align="left">3.45</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">3</td>
<td align="left">12</td>
<td align="left">▇▂▁▁▁▁▁▁</td>
<td align="left">F2.0</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (show_missing_values) {
  <span class="kw">plot_labelled</span>(missing_values, item_name, wrap_at)
}</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(item_info)) {
  <span class="co"># don&#39;t show choices again, if they&#39;re basically same thing as value labels</span>
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.null</span>(item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">names</span>(<span class="kw">na.omit</span>(choices)) <span class="op">==</span><span class="st"> </span>item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">na.omit</span>(choices) <span class="op">==</span><span class="st"> </span><span class="kw">names</span>(item_info<span class="op">$</span>choices))) {
    item_info<span class="op">$</span>choices &lt;-<span class="st"> </span><span class="ot">NULL</span>
  }
  item_info<span class="op">$</span>label_parsed &lt;-<span class="st"> </span>
<span class="st">    </span>item_info<span class="op">$</span>choice_list &lt;-<span class="st"> </span>item_info<span class="op">$</span>study_id &lt;-<span class="st"> </span>item_info<span class="op">$</span>id &lt;-<span class="st"> </span><span class="ot">NULL</span>
  pander<span class="op">::</span><span class="kw">pander</span>(item_info)
}</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span>) {
    pander<span class="op">::</span><span class="kw">pander</span>(<span class="kw">as.list</span>(choices))
}</code></pre>
</div>
</div>
<div id="grade" class="section level3 tabset">
<h3><span class="header-section-number">2.2.14</span> grade</h3>
<p>grade</p>
<div id="grade_distribution" class="section level4">
<h4><span class="header-section-number">2.2.14.1</span> Distribution</h4>
<pre class="sourceCode r"><code class="sourceCode r">show_missing_values &lt;-<span class="st"> </span><span class="ot">FALSE</span>
<span class="cf">if</span> (<span class="kw">has_labels</span>(item)) {
  missing_values &lt;-<span class="st"> </span>item[<span class="kw">is.na</span>(haven<span class="op">::</span><span class="kw">zap_missing</span>(item))]
  <span class="kw">attributes</span>(missing_values) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)) {
    <span class="kw">attributes</span>(missing_values)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(missing_values)<span class="op">$</span>labels[<span class="kw">is.na</span>(<span class="kw">attributes</span>(missing_values)<span class="op">$</span>labels)]
    <span class="kw">attributes</span>(item)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)<span class="op">$</span>labels[<span class="op">!</span><span class="kw">is.na</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)]
  }
  <span class="cf">if</span> (<span class="kw">is.double</span>(item)) {
    show_missing_values &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(haven<span class="op">::</span><span class="kw">na_tag</span>(missing_values))) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_missing</span>(item)
  }
  <span class="cf">if</span> (<span class="kw">length</span>(item_attributes<span class="op">$</span>labels) <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.numeric</span>(item)) {
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_labels</span>(item)
  }
}
item_nomiss &lt;-<span class="st"> </span>item[<span class="op">!</span><span class="kw">is.na</span>(item)]

<span class="co"># unnest mc_multiple and so on</span>
<span class="cf">if</span> (
  <span class="kw">is.character</span>(item_nomiss) <span class="op">&amp;&amp;</span>
<span class="st">  </span><span class="kw">any</span>(stringr<span class="op">::</span><span class="kw">str_detect</span>(item_nomiss, stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>))) <span class="op">&amp;&amp;</span>
<span class="st">  </span><span class="op">!</span><span class="kw">is.null</span>(item_info) <span class="op">&amp;&amp;</span>
<span class="st">  </span>(<span class="kw">exists</span>(<span class="st">&quot;type&quot;</span>, item_info) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span><span class="kw">any</span>(stringr<span class="op">::</span><span class="kw">str_detect</span>(item_info<span class="op">$</span>type, 
                            <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;multiple&quot;</span>))))
  ) {
  item_nomiss &lt;-<span class="st"> </span><span class="kw">unlist</span>(stringr<span class="op">::</span><span class="kw">str_split</span>(item_nomiss, <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>)))
}
<span class="kw">attributes</span>(item_nomiss) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)

old_height &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.height&quot;</span>)
non_missing_choices &lt;-<span class="st"> </span>item_attributes[[<span class="st">&quot;labels&quot;</span>]]
many_labels &lt;-<span class="st"> </span><span class="kw">length</span>(non_missing_choices) <span class="op">&gt;</span><span class="st"> </span><span class="dv">7</span>
go_vertical &lt;-<span class="st"> </span><span class="op">!</span><span class="kw">is_numeric_or_time_var</span>(item_nomiss) <span class="op">||</span><span class="st"> </span>many_labels
  
<span class="cf">if</span> ( go_vertical ) {
  <span class="co"># numeric items are plotted horizontally (because that&#39;s what usually expected)</span>
  <span class="co"># categorical items are plotted vertically because we can use the screen real estate better this way</span>

    <span class="cf">if</span> (<span class="kw">is.null</span>(choices) <span class="op">||</span><span class="st"> </span>
<span class="st">        </span>dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss) <span class="op">&gt;</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)) {
        non_missing_choices &lt;-<span class="st"> </span><span class="kw">unique</span>(item_nomiss)
        <span class="kw">names</span>(non_missing_choices) &lt;-<span class="st"> </span>non_missing_choices
    }
  choice_multiplier &lt;-<span class="st"> </span>old_height<span class="op">/</span><span class="fl">6.5</span>
    new_height &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>choice_multiplier <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&gt;</span><span class="st"> </span><span class="dv">20</span>, <span class="dv">20</span>, new_height)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">1</span>, new_height)
    <span class="cf">if</span>(<span class="kw">could_disclose_unique_values</span>(item_nomiss) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.character</span>(item_nomiss)) {
      new_height &lt;-<span class="st"> </span>old_height
    }
    knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> new_height)
}

wrap_at &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.width&quot;</span>) <span class="op">*</span><span class="st"> </span><span class="dv">10</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># todo: if there are free-text choices mingled in with the pre-defined ones, don&#39;t show</span>
<span class="co"># todo: show rare items if they are pre-defined</span>
<span class="co"># todo: bin rare responses into &quot;other category&quot;</span>
<span class="cf">if</span> (<span class="op">!</span><span class="kw">length</span>(item_nomiss)) {
  <span class="kw">cat</span>(<span class="st">&quot;No non-missing values to show.&quot;</span>)
} <span class="cf">else</span> <span class="cf">if</span> (<span class="op">!</span><span class="kw">could_disclose_unique_values</span>(item_nomiss)) {
  <span class="kw">plot_labelled</span>(item_nomiss, item_name, wrap_at, go_vertical)
} <span class="cf">else</span> {
  <span class="cf">if</span> (<span class="kw">is.character</span>(item_nomiss)) {
      char_count &lt;-<span class="st"> </span>stringr<span class="op">::</span><span class="kw">str_count</span>(item_nomiss)
      <span class="kw">attributes</span>(char_count)<span class="op">$</span>label &lt;-<span class="st"> </span>item_label
      <span class="kw">plot_labelled</span>(char_count, 
                    item_name, wrap_at, <span class="ot">FALSE</span>, <span class="dt">trans =</span> <span class="st">&quot;log1p&quot;</span>, <span class="st">&quot;characters&quot;</span>)
  } <span class="cf">else</span> {
      <span class="kw">cat</span>(dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss), <span class="st">&quot; unique, categorical values, so not shown.&quot;</span>)
  }
}</code></pre>
<p><img src="_main_files/figure-html/grade_distribution-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> old_height)</code></pre>
<p>40 missing values.</p>
</div>
<div id="grade_summary" class="section level4">
<h4><span class="header-section-number">2.2.14.2</span> Summary statistics</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attributes</span>(item) &lt;-<span class="st"> </span>item_attributes
df =<span class="st"> </span><span class="kw">data.frame</span>(item, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
<span class="kw">names</span>(df) =<span class="st"> </span>html_item_name
<span class="kw">escaped_table</span>(<span class="kw">codebook_table</span>(df))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">name</th>
<th align="left">label</th>
<th align="left">data_type</th>
<th align="left">value_labels</th>
<th align="left">missing</th>
<th align="left">complete</th>
<th align="left">n</th>
<th align="left">mean</th>
<th align="left">sd</th>
<th align="left">p0</th>
<th align="left">p25</th>
<th align="left">p50</th>
<th align="left">p75</th>
<th align="left">p100</th>
<th align="left">hist</th>
<th align="left">format.spss</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">grade</td>
<td align="left">grade</td>
<td align="left">numeric</td>
<td align="left">1. Fourth grade,<br>2. Fifth grade</td>
<td align="left">40</td>
<td align="left">367</td>
<td align="left">407</td>
<td align="left">1.47</td>
<td align="left">0.5</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">2</td>
<td align="left">2</td>
<td align="left">▇▁▁▁▁▁▁▇</td>
<td align="left">F2.0</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (show_missing_values) {
  <span class="kw">plot_labelled</span>(missing_values, item_name, wrap_at)
}</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(item_info)) {
  <span class="co"># don&#39;t show choices again, if they&#39;re basically same thing as value labels</span>
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.null</span>(item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">names</span>(<span class="kw">na.omit</span>(choices)) <span class="op">==</span><span class="st"> </span>item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">na.omit</span>(choices) <span class="op">==</span><span class="st"> </span><span class="kw">names</span>(item_info<span class="op">$</span>choices))) {
    item_info<span class="op">$</span>choices &lt;-<span class="st"> </span><span class="ot">NULL</span>
  }
  item_info<span class="op">$</span>label_parsed &lt;-<span class="st"> </span>
<span class="st">    </span>item_info<span class="op">$</span>choice_list &lt;-<span class="st"> </span>item_info<span class="op">$</span>study_id &lt;-<span class="st"> </span>item_info<span class="op">$</span>id &lt;-<span class="st"> </span><span class="ot">NULL</span>
  pander<span class="op">::</span><span class="kw">pander</span>(item_info)
}</code></pre>
</div>
<div id="grade_labels" class="section level4">
<h4><span class="header-section-number">2.2.14.3</span> Value labels</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span>) {
    pander<span class="op">::</span><span class="kw">pander</span>(<span class="kw">as.list</span>(choices))
}</code></pre>
<ul>
<li><strong>Fourth grade</strong>: <em>1</em></li>
<li><strong>Fifth grade</strong>: <em>2</em></li>
</ul>
<!-- end of list -->
</div>
</div>
<div id="CSIW" class="section level3 tabset">
<h3><span class="header-section-number">2.2.15</span> CSIW</h3>
<div id="CSIW_distribution" class="section level4">
<h4><span class="header-section-number">2.2.15.1</span> Distribution</h4>
<pre class="sourceCode r"><code class="sourceCode r">show_missing_values &lt;-<span class="st"> </span><span class="ot">FALSE</span>
<span class="cf">if</span> (<span class="kw">has_labels</span>(item)) {
  missing_values &lt;-<span class="st"> </span>item[<span class="kw">is.na</span>(haven<span class="op">::</span><span class="kw">zap_missing</span>(item))]
  <span class="kw">attributes</span>(missing_values) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)) {
    <span class="kw">attributes</span>(missing_values)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(missing_values)<span class="op">$</span>labels[<span class="kw">is.na</span>(<span class="kw">attributes</span>(missing_values)<span class="op">$</span>labels)]
    <span class="kw">attributes</span>(item)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)<span class="op">$</span>labels[<span class="op">!</span><span class="kw">is.na</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)]
  }
  <span class="cf">if</span> (<span class="kw">is.double</span>(item)) {
    show_missing_values &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(haven<span class="op">::</span><span class="kw">na_tag</span>(missing_values))) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_missing</span>(item)
  }
  <span class="cf">if</span> (<span class="kw">length</span>(item_attributes<span class="op">$</span>labels) <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.numeric</span>(item)) {
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_labels</span>(item)
  }
}
item_nomiss &lt;-<span class="st"> </span>item[<span class="op">!</span><span class="kw">is.na</span>(item)]

<span class="co"># unnest mc_multiple and so on</span>
<span class="cf">if</span> (
  <span class="kw">is.character</span>(item_nomiss) <span class="op">&amp;&amp;</span>
<span class="st">  </span><span class="kw">any</span>(stringr<span class="op">::</span><span class="kw">str_detect</span>(item_nomiss, stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>))) <span class="op">&amp;&amp;</span>
<span class="st">  </span><span class="op">!</span><span class="kw">is.null</span>(item_info) <span class="op">&amp;&amp;</span>
<span class="st">  </span>(<span class="kw">exists</span>(<span class="st">&quot;type&quot;</span>, item_info) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span><span class="kw">any</span>(stringr<span class="op">::</span><span class="kw">str_detect</span>(item_info<span class="op">$</span>type, 
                            <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;multiple&quot;</span>))))
  ) {
  item_nomiss &lt;-<span class="st"> </span><span class="kw">unlist</span>(stringr<span class="op">::</span><span class="kw">str_split</span>(item_nomiss, <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>)))
}
<span class="kw">attributes</span>(item_nomiss) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)

old_height &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.height&quot;</span>)
non_missing_choices &lt;-<span class="st"> </span>item_attributes[[<span class="st">&quot;labels&quot;</span>]]
many_labels &lt;-<span class="st"> </span><span class="kw">length</span>(non_missing_choices) <span class="op">&gt;</span><span class="st"> </span><span class="dv">7</span>
go_vertical &lt;-<span class="st"> </span><span class="op">!</span><span class="kw">is_numeric_or_time_var</span>(item_nomiss) <span class="op">||</span><span class="st"> </span>many_labels
  
<span class="cf">if</span> ( go_vertical ) {
  <span class="co"># numeric items are plotted horizontally (because that&#39;s what usually expected)</span>
  <span class="co"># categorical items are plotted vertically because we can use the screen real estate better this way</span>

    <span class="cf">if</span> (<span class="kw">is.null</span>(choices) <span class="op">||</span><span class="st"> </span>
<span class="st">        </span>dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss) <span class="op">&gt;</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)) {
        non_missing_choices &lt;-<span class="st"> </span><span class="kw">unique</span>(item_nomiss)
        <span class="kw">names</span>(non_missing_choices) &lt;-<span class="st"> </span>non_missing_choices
    }
  choice_multiplier &lt;-<span class="st"> </span>old_height<span class="op">/</span><span class="fl">6.5</span>
    new_height &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>choice_multiplier <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&gt;</span><span class="st"> </span><span class="dv">20</span>, <span class="dv">20</span>, new_height)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">1</span>, new_height)
    <span class="cf">if</span>(<span class="kw">could_disclose_unique_values</span>(item_nomiss) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.character</span>(item_nomiss)) {
      new_height &lt;-<span class="st"> </span>old_height
    }
    knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> new_height)
}

wrap_at &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.width&quot;</span>) <span class="op">*</span><span class="st"> </span><span class="dv">10</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># todo: if there are free-text choices mingled in with the pre-defined ones, don&#39;t show</span>
<span class="co"># todo: show rare items if they are pre-defined</span>
<span class="co"># todo: bin rare responses into &quot;other category&quot;</span>
<span class="cf">if</span> (<span class="op">!</span><span class="kw">length</span>(item_nomiss)) {
  <span class="kw">cat</span>(<span class="st">&quot;No non-missing values to show.&quot;</span>)
} <span class="cf">else</span> <span class="cf">if</span> (<span class="op">!</span><span class="kw">could_disclose_unique_values</span>(item_nomiss)) {
  <span class="kw">plot_labelled</span>(item_nomiss, item_name, wrap_at, go_vertical)
} <span class="cf">else</span> {
  <span class="cf">if</span> (<span class="kw">is.character</span>(item_nomiss)) {
      char_count &lt;-<span class="st"> </span>stringr<span class="op">::</span><span class="kw">str_count</span>(item_nomiss)
      <span class="kw">attributes</span>(char_count)<span class="op">$</span>label &lt;-<span class="st"> </span>item_label
      <span class="kw">plot_labelled</span>(char_count, 
                    item_name, wrap_at, <span class="ot">FALSE</span>, <span class="dt">trans =</span> <span class="st">&quot;log1p&quot;</span>, <span class="st">&quot;characters&quot;</span>)
  } <span class="cf">else</span> {
      <span class="kw">cat</span>(dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss), <span class="st">&quot; unique, categorical values, so not shown.&quot;</span>)
  }
}</code></pre>
<p><img src="_main_files/figure-html/CSIW_distribution-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> old_height)</code></pre>
<p>0 missing values.</p>
</div>
<div id="CSIW_summary" class="section level4">
<h4><span class="header-section-number">2.2.15.2</span> Summary statistics</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attributes</span>(item) &lt;-<span class="st"> </span>item_attributes
df =<span class="st"> </span><span class="kw">data.frame</span>(item, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
<span class="kw">names</span>(df) =<span class="st"> </span>html_item_name
<span class="kw">escaped_table</span>(<span class="kw">codebook_table</span>(df))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">name</th>
<th align="left">data_type</th>
<th align="left">missing</th>
<th align="left">complete</th>
<th align="left">n</th>
<th align="left">mean</th>
<th align="left">sd</th>
<th align="left">p0</th>
<th align="left">p25</th>
<th align="left">p50</th>
<th align="left">p75</th>
<th align="left">p100</th>
<th align="left">hist</th>
<th align="left">format.spss</th>
<th align="left">display_width</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">CSIW</td>
<td align="left">numeric</td>
<td align="left">0</td>
<td align="left">407</td>
<td align="left">407</td>
<td align="left">0.7</td>
<td align="left">0.46</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">▃▁▁▁▁▁▁▇</td>
<td align="left">F8.2</td>
<td align="left">10</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (show_missing_values) {
  <span class="kw">plot_labelled</span>(missing_values, item_name, wrap_at)
}</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(item_info)) {
  <span class="co"># don&#39;t show choices again, if they&#39;re basically same thing as value labels</span>
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.null</span>(item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">names</span>(<span class="kw">na.omit</span>(choices)) <span class="op">==</span><span class="st"> </span>item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">na.omit</span>(choices) <span class="op">==</span><span class="st"> </span><span class="kw">names</span>(item_info<span class="op">$</span>choices))) {
    item_info<span class="op">$</span>choices &lt;-<span class="st"> </span><span class="ot">NULL</span>
  }
  item_info<span class="op">$</span>label_parsed &lt;-<span class="st"> </span>
<span class="st">    </span>item_info<span class="op">$</span>choice_list &lt;-<span class="st"> </span>item_info<span class="op">$</span>study_id &lt;-<span class="st"> </span>item_info<span class="op">$</span>id &lt;-<span class="st"> </span><span class="ot">NULL</span>
  pander<span class="op">::</span><span class="kw">pander</span>(item_info)
}</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span>) {
    pander<span class="op">::</span><span class="kw">pander</span>(<span class="kw">as.list</span>(choices))
}</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">missingness_report</code></pre>
</div>
</div>
</div>
<div id="missingness-report" class="section level2">
<h2><span class="header-section-number">2.3</span> Missingness report</h2>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="kw">length</span>(md_pattern)) {
  <span class="cf">if</span> (knitr<span class="op">::</span><span class="kw">is_html_output</span>()) {
    rmarkdown<span class="op">::</span><span class="kw">paged_table</span>(md_pattern, <span class="dt">options =</span> <span class="kw">list</span>(<span class="dt">rows.print =</span> <span class="dv">10</span>))
  } <span class="cf">else</span> {
    knitr<span class="op">::</span><span class="kw">kable</span>(md_pattern)
  }
}</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["description"],"name":[1],"type":["chr"],"align":["left"]},{"label":["group"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["grade"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["cch1"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["pre_test"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["ccprod1"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["ccrdr1"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["cch2"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["post_test"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["ccprod2"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["ccrdr2"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["var_miss"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["n_miss"],"name":[13],"type":["dbl"],"align":["right"]}],"data":[{"1":"Missing values per variable","2":"40","3":"40","4":"79","5":"79","6":"79","7":"79","8":"81","9":"81","10":"81","11":"82","12":"721","13":"721"},{"1":"Missing values in 0 variables","2":"1","3":"1","4":"1","5":"1","6":"1","7":"1","8":"1","9":"1","10":"1","11":"1","12":"0","13":"258"},{"1":"Missing values in 4 variables","2":"1","3":"1","4":"1","5":"1","6":"1","7":"1","8":"0","9":"0","10":"0","11":"0","12":"4","13":"39"},{"1":"Missing values in 4 variables","2":"1","3":"1","4":"0","5":"0","6":"0","7":"0","8":"1","9":"1","10":"1","11":"1","12":"4","13":"21"},{"1":"Missing values in 5 variables","2":"1","3":"0","4":"0","5":"0","6":"0","7":"0","8":"1","9":"1","10":"1","11":"1","12":"5","13":"21"},{"1":"Missing values in 1 variables","2":"0","3":"1","4":"1","5":"1","6":"1","7":"1","8":"1","9":"1","10":"1","11":"1","12":"1","13":"10"},{"1":"Missing values in 5 variables","2":"0","3":"1","4":"0","5":"0","6":"0","7":"0","8":"1","9":"1","10":"1","11":"1","12":"5","13":"10"},{"1":"Missing values in 9 variables","2":"0","3":"1","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"9","13":"10"},{"1":"Missing values in 8 variables","2":"1","3":"1","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"8","13":"9"},{"1":"Missing values in 5 variables","2":"0","3":"1","4":"1","5":"1","6":"1","7":"1","8":"0","9":"0","10":"0","11":"0","12":"5","13":"9"},{"1":"Missing values in 5 variables","2":"1","3":"0","4":"1","5":"1","6":"1","7":"1","8":"0","9":"0","10":"0","11":"0","12":"5","13":"7"},{"1":"Missing values in 9 variables","2":"1","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"9","13":"7"},{"1":"3 other, less frequent patterns","2":"2","3":"1","4":"2","5":"2","6":"2","7":"2","8":"3","9":"3","10":"3","11":"2","12":"8","13":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="sourceCode r"><code class="sourceCode r">items</code></pre>
</div>
<div id="codebook-table" class="section level2">
<h2><span class="header-section-number">2.4</span> Codebook table</h2>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">export_table</span>(metadata_table)</code></pre>
<div id="htmlwidget-04ecafb2d880779891b4" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-04ecafb2d880779891b4">{"x":{"filter":"top","filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"disabled\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"disabled\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons"],"data":[["<a href=\"#school\">school<\/a>","<a href=\"#teacher\">teacher<\/a>","<a href=\"#id\">id<\/a>","<a href=\"#group\">group<\/a>","<a href=\"#treatmt\">treatmt<\/a>","<a href=\"#cch1\">cch1<\/a>","<a href=\"#cch2\">cch2<\/a>","<a href=\"#pre_test\">pre_test<\/a>","<a href=\"#post_test\">post_test<\/a>","<a href=\"#ccprod1\">ccprod1<\/a>","<a href=\"#ccprod2\">ccprod2<\/a>","<a href=\"#ccrdr1\">ccrdr1<\/a>","<a href=\"#ccrdr2\">ccrdr2<\/a>","<a href=\"#grade\">grade<\/a>","<a href=\"#CSIW\">CSIW<\/a>"],["school id","teacher id","student id","Achievement Level","treatment condition","holistic, pretest","holistic, posttest","pre_test","post_test","productivity, pretest","productivity, posttest","r. sensitivity, pretest","r. sensitivity, posttest","grade",null],["numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric"],[null,null,null,"1. High achieving,<br>2. Average achieving,<br>3. Low achieving,<br>4. Learning disabled","1. Experimental,<br>2. Control",null,null,null,null,null,null,null,null,"1. Fourth grade,<br>2. Fifth grade",null],["0","0","0","40","0","79","81","79","81","79","81","79","82","40","0"],["407","407","407","367","407","328","326","328","326","328","326","328","325","367","407"],["407","407","407","407","407","407","407","407","407","407","407","407","407","407","407"],[" 4.51","10.91","32.12"," 2.66"," 1.3 "," 1.14"," 1.66"," 6.02"," 8.6 "," 3.92"," 4.91"," 0.86"," 2.48"," 1.47"," 0.7 "],[" 3.95"," 7.71","15.7 "," 1.17"," 0.46"," 0.76"," 0.75"," 3.62"," 3.56"," 3.22"," 2.98"," 1.33"," 3.45"," 0.5 "," 0.46"],["1","1","1","1","1","0","0","0","0","0","0","0","0","1","0"],["1","4","20","2","1","1","1","4","6","2","3","0","0","1","0"],["2","8","35","3","1","1","2","6","9","4","5","0","1","1","1"],["9","18","44","4","2","2","2","9","11","6","7","1","3","2","1"],["13","55","61","4","2","3","3","16","15","17","19","8","12","2","1"],["▇▁▁▁▁▃▁▁","▇▃▅▂▁▁▁▁","▃▃▂▃▇▆▅▂","▆▁▅▁▁▅▁▇","▇▁▁▁▁▁▁▃","▃▁▇▁▁▆▁▁","▁▁▅▁▁▇▁▂","▆▃▇▆▅▃▁▁","▂▂▅▆▆▇▆▃","▇▅▃▂▂▁▁▁","▅▆▇▂▁▁▁▁","▇▁▁▁▁▁▁▁","▇▂▁▁▁▁▁▁","▇▁▁▁▁▁▁▇","▃▁▁▁▁▁▁▇"],["F2.0","F2.0","F2.0","F2.0","F2.0","F2.0","F2.0","F2.0","F2.0","F2.0","F2.0","F2.0","F2.0","F2.0","F8.2"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,"10"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>name<\/th>\n      <th>label<\/th>\n      <th>data_type<\/th>\n      <th>value_labels<\/th>\n      <th>missing<\/th>\n      <th>complete<\/th>\n      <th>n<\/th>\n      <th>mean<\/th>\n      <th>sd<\/th>\n      <th>p0<\/th>\n      <th>p25<\/th>\n      <th>p50<\/th>\n      <th>p75<\/th>\n      <th>p100<\/th>\n      <th>hist<\/th>\n      <th>format.spss<\/th>\n      <th>display_width<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","buttons":["copy","csv","excel","pdf","print"],"pageLength":200,"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"lengthMenu":[10,25,50,100,200]},"selection":{"mode":"multiple","selected":null,"target":"row"}},"evals":[],"jsHooks":[]}</script>
<pre class="sourceCode r"><code class="sourceCode r">jsonld</code></pre>
<script type="application/ld+json">
{
  "name": "csiw",
  "datePublished": "2019-04-29",
  "description": "The dataset has N=407 rows and 15 columns.\n258 rows have no missing values on any column.\n\n\n## Table of variables\nThis table contains variable names, labels, their central tendencies and other attributes.\n\n|name      |label                    |data_type |value_labels                                                                    |missing |complete |n   |mean  |sd   |p0 |p25 |p50 |p75 |p100 |hist     |format.spss |display_width |\n|:---------|:------------------------|:---------|:-------------------------------------------------------------------------------|:-------|:--------|:---|:-----|:----|:--|:---|:---|:---|:----|:--------|:-----------|:-------------|\n|school    |school id                |numeric   |NA                                                                              |0       |407      |407 |4.51  |3.95 |1  |1   |2   |9   |13   |▇▁▁▁▁▃▁▁ |F2.0        |NA            |\n|teacher   |teacher id               |numeric   |NA                                                                              |0       |407      |407 |10.91 |7.71 |1  |4   |8   |18  |55   |▇▃▅▂▁▁▁▁ |F2.0        |NA            |\n|id        |student id               |numeric   |NA                                                                              |0       |407      |407 |32.12 |15.7 |1  |20  |35  |44  |61   |▃▃▂▃▇▆▅▂ |F2.0        |NA            |\n|group     |Achievement Level        |numeric   |1. High achieving, - 2. Average achieving, - 3. Low achieving, - 4. Learning disabled |40      |367      |407 |2.66  |1.17 |1  |2   |3   |4   |4    |▆▁▅▁▁▅▁▇ |F2.0        |NA            |\n|treatmt   |treatment condition      |numeric   |1. Experimental, - 2. Control                                                     |0       |407      |407 |1.3   |0.46 |1  |1   |1   |2   |2    |▇▁▁▁▁▁▁▃ |F2.0        |NA            |\n|cch1      |holistic, pretest        |numeric   |NA                                                                              |79      |328      |407 |1.14  |0.76 |0  |1   |1   |2   |3    |▃▁▇▁▁▆▁▁ |F2.0        |NA            |\n|cch2      |holistic, posttest       |numeric   |NA                                                                              |81      |326      |407 |1.66  |0.75 |0  |1   |2   |2   |3    |▁▁▅▁▁▇▁▂ |F2.0        |NA            |\n|pre_test  |pre_test                 |numeric   |NA                                                                              |79      |328      |407 |6.02  |3.62 |0  |4   |6   |9   |16   |▆▃▇▆▅▃▁▁ |F2.0        |NA            |\n|post_test |post_test                |numeric   |NA                                                                              |81      |326      |407 |8.6   |3.56 |0  |6   |9   |11  |15   |▂▂▅▆▆▇▆▃ |F2.0        |NA            |\n|ccprod1   |productivity, pretest    |numeric   |NA                                                                              |79      |328      |407 |3.92  |3.22 |0  |2   |4   |6   |17   |▇▅▃▂▂▁▁▁ |F2.0        |NA            |\n|ccprod2   |productivity, posttest   |numeric   |NA                                                                              |81      |326      |407 |4.91  |2.98 |0  |3   |5   |7   |19   |▅▆▇▂▁▁▁▁ |F2.0        |NA            |\n|ccrdr1    |r. sensitivity, pretest  |numeric   |NA                                                                              |79      |328      |407 |0.86  |1.33 |0  |0   |0   |1   |8    |▇▁▁▁▁▁▁▁ |F2.0        |NA            |\n|ccrdr2    |r. sensitivity, posttest |numeric   |NA                                                                              |82      |325      |407 |2.48  |3.45 |0  |0   |1   |3   |12   |▇▂▁▁▁▁▁▁ |F2.0        |NA            |\n|grade     |grade                    |numeric   |1. Fourth grade, - 2. Fifth grade                                                 |40      |367      |407 |1.47  |0.5  |1  |1   |1   |2   |2    |▇▁▁▁▁▁▁▇ |F2.0        |NA            |\n|CSIW      |NA                       |numeric   |NA                                                                              |0       |407      |407 |0.7   |0.46 |0  |0   |1   |1   |1    |▃▁▁▁▁▁▁▇ |F8.2        |10            |\n\n### Note\nThis dataset was automatically described using the [codebook R package](https://rubenarslan.github.io/codebook/) (version 0.8.0).",
  "keywords": ["school", "teacher", "id", "group", "treatmt", "cch1", "cch2", "pre_test", "post_test", "ccprod1", "ccprod2", "ccrdr1", "ccrdr2", "grade", "CSIW"],
  "@context": "http://schema.org/",
  "@type": "Dataset",
  "variableMeasured": [
    {
      "name": "school",
      "description": "school id",
      "@type": "propertyValue"
    },
    {
      "name": "teacher",
      "description": "teacher id",
      "@type": "propertyValue"
    },
    {
      "name": "id",
      "description": "student id",
      "@type": "propertyValue"
    },
    {
      "name": "group",
      "description": "Achievement Level",
      "value": "1. High achieving,\n2. Average achieving,\n3. Low achieving,\n4. Learning disabled",
      "maxValue": 4,
      "minValue": 1,
      "@type": "propertyValue"
    },
    {
      "name": "treatmt",
      "description": "treatment condition",
      "value": "1. Experimental,\n2. Control",
      "maxValue": 2,
      "minValue": 1,
      "@type": "propertyValue"
    },
    {
      "name": "cch1",
      "description": "holistic, pretest",
      "@type": "propertyValue"
    },
    {
      "name": "cch2",
      "description": "holistic, posttest",
      "@type": "propertyValue"
    },
    {
      "name": "pre_test",
      "description": "pre_test",
      "@type": "propertyValue"
    },
    {
      "name": "post_test",
      "description": "post_test",
      "@type": "propertyValue"
    },
    {
      "name": "ccprod1",
      "description": "productivity, pretest",
      "@type": "propertyValue"
    },
    {
      "name": "ccprod2",
      "description": "productivity, posttest",
      "@type": "propertyValue"
    },
    {
      "name": "ccrdr1",
      "description": "r. sensitivity, pretest",
      "@type": "propertyValue"
    },
    {
      "name": "ccrdr2",
      "description": "r. sensitivity, posttest",
      "@type": "propertyValue"
    },
    {
      "name": "grade",
      "description": "grade",
      "value": "1. Fourth grade,\n2. Fifth grade",
      "maxValue": 2,
      "minValue": 1,
      "@type": "propertyValue"
    },
    {
      "name": "CSIW",
      "@type": "propertyValue"
    }
  ]
}
</script>
<details>
<p><summary>JSON-LD metadata</summary>
The following JSON-LD can be found by search engines, if you share this codebook
publicly on the web.</p>
<pre class="sourceCode json"><code class="sourceCode json"><span class="fu">{</span>
  <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;csiw&quot;</span><span class="fu">,</span>
  <span class="dt">&quot;datePublished&quot;</span><span class="fu">:</span> <span class="st">&quot;2019-04-29&quot;</span><span class="fu">,</span>
  <span class="dt">&quot;description&quot;</span><span class="fu">:</span> <span class="st">&quot;The dataset has N=407 rows and 15 columns.</span><span class="ch">\n</span><span class="st">258 rows have no missing values on any column.</span><span class="ch">\n\n\n</span><span class="st">## Table of variables</span><span class="ch">\n</span><span class="st">This table contains variable names, labels, their central tendencies and other attributes.</span><span class="ch">\n\n</span><span class="st">|name      |label                    |data_type |value_labels                                                                    |missing |complete |n   |mean  |sd   |p0 |p25 |p50 |p75 |p100 |hist     |format.spss |display_width |</span><span class="ch">\n</span><span class="st">|:---------|:------------------------|:---------|:-------------------------------------------------------------------------------|:-------|:--------|:---|:-----|:----|:--|:---|:---|:---|:----|:--------|:-----------|:-------------|</span><span class="ch">\n</span><span class="st">|school    |school id                |numeric   |NA                                                                              |0       |407      |407 |4.51  |3.95 |1  |1   |2   |9   |13   |▇▁▁▁▁▃▁▁ |F2.0        |NA            |</span><span class="ch">\n</span><span class="st">|teacher   |teacher id               |numeric   |NA                                                                              |0       |407      |407 |10.91 |7.71 |1  |4   |8   |18  |55   |▇▃▅▂▁▁▁▁ |F2.0        |NA            |</span><span class="ch">\n</span><span class="st">|id        |student id               |numeric   |NA                                                                              |0       |407      |407 |32.12 |15.7 |1  |20  |35  |44  |61   |▃▃▂▃▇▆▅▂ |F2.0        |NA            |</span><span class="ch">\n</span><span class="st">|group     |Achievement Level        |numeric   |1. High achieving, - 2. Average achieving, - 3. Low achieving, - 4. Learning disabled |40      |367      |407 |2.66  |1.17 |1  |2   |3   |4   |4    |▆▁▅▁▁▅▁▇ |F2.0        |NA            |</span><span class="ch">\n</span><span class="st">|treatmt   |treatment condition      |numeric   |1. Experimental, - 2. Control                                                     |0       |407      |407 |1.3   |0.46 |1  |1   |1   |2   |2    |▇▁▁▁▁▁▁▃ |F2.0        |NA            |</span><span class="ch">\n</span><span class="st">|cch1      |holistic, pretest        |numeric   |NA                                                                              |79      |328      |407 |1.14  |0.76 |0  |1   |1   |2   |3    |▃▁▇▁▁▆▁▁ |F2.0        |NA            |</span><span class="ch">\n</span><span class="st">|cch2      |holistic, posttest       |numeric   |NA                                                                              |81      |326      |407 |1.66  |0.75 |0  |1   |2   |2   |3    |▁▁▅▁▁▇▁▂ |F2.0        |NA            |</span><span class="ch">\n</span><span class="st">|pre_test  |pre_test                 |numeric   |NA                                                                              |79      |328      |407 |6.02  |3.62 |0  |4   |6   |9   |16   |▆▃▇▆▅▃▁▁ |F2.0        |NA            |</span><span class="ch">\n</span><span class="st">|post_test |post_test                |numeric   |NA                                                                              |81      |326      |407 |8.6   |3.56 |0  |6   |9   |11  |15   |▂▂▅▆▆▇▆▃ |F2.0        |NA            |</span><span class="ch">\n</span><span class="st">|ccprod1   |productivity, pretest    |numeric   |NA                                                                              |79      |328      |407 |3.92  |3.22 |0  |2   |4   |6   |17   |▇▅▃▂▂▁▁▁ |F2.0        |NA            |</span><span class="ch">\n</span><span class="st">|ccprod2   |productivity, posttest   |numeric   |NA                                                                              |81      |326      |407 |4.91  |2.98 |0  |3   |5   |7   |19   |▅▆▇▂▁▁▁▁ |F2.0        |NA            |</span><span class="ch">\n</span><span class="st">|ccrdr1    |r. sensitivity, pretest  |numeric   |NA                                                                              |79      |328      |407 |0.86  |1.33 |0  |0   |0   |1   |8    |▇▁▁▁▁▁▁▁ |F2.0        |NA            |</span><span class="ch">\n</span><span class="st">|ccrdr2    |r. sensitivity, posttest |numeric   |NA                                                                              |82      |325      |407 |2.48  |3.45 |0  |0   |1   |3   |12   |▇▂▁▁▁▁▁▁ |F2.0        |NA            |</span><span class="ch">\n</span><span class="st">|grade     |grade                    |numeric   |1. Fourth grade, - 2. Fifth grade                                                 |40      |367      |407 |1.47  |0.5  |1  |1   |1   |2   |2    |▇▁▁▁▁▁▁▇ |F2.0        |NA            |</span><span class="ch">\n</span><span class="st">|CSIW      |NA                       |numeric   |NA                                                                              |0       |407      |407 |0.7   |0.46 |0  |0   |1   |1   |1    |▃▁▁▁▁▁▁▇ |F8.2        |10            |</span><span class="ch">\n\n</span><span class="st">### Note</span><span class="ch">\n</span><span class="st">This dataset was automatically described using the [codebook R package](https://rubenarslan.github.io/codebook/) (version 0.8.0).&quot;</span><span class="fu">,</span>
  <span class="dt">&quot;keywords&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="st">&quot;school&quot;</span><span class="ot">,</span> <span class="st">&quot;teacher&quot;</span><span class="ot">,</span> <span class="st">&quot;id&quot;</span><span class="ot">,</span> <span class="st">&quot;group&quot;</span><span class="ot">,</span> <span class="st">&quot;treatmt&quot;</span><span class="ot">,</span> <span class="st">&quot;cch1&quot;</span><span class="ot">,</span> <span class="st">&quot;cch2&quot;</span><span class="ot">,</span> <span class="st">&quot;pre_test&quot;</span><span class="ot">,</span> <span class="st">&quot;post_test&quot;</span><span class="ot">,</span> <span class="st">&quot;ccprod1&quot;</span><span class="ot">,</span> <span class="st">&quot;ccprod2&quot;</span><span class="ot">,</span> <span class="st">&quot;ccrdr1&quot;</span><span class="ot">,</span> <span class="st">&quot;ccrdr2&quot;</span><span class="ot">,</span> <span class="st">&quot;grade&quot;</span><span class="ot">,</span> <span class="st">&quot;CSIW&quot;</span><span class="ot">]</span><span class="fu">,</span>
  <span class="dt">&quot;@context&quot;</span><span class="fu">:</span> <span class="st">&quot;http://schema.org/&quot;</span><span class="fu">,</span>
  <span class="dt">&quot;@type&quot;</span><span class="fu">:</span> <span class="st">&quot;Dataset&quot;</span><span class="fu">,</span>
  <span class="dt">&quot;variableMeasured&quot;</span><span class="fu">:</span> <span class="ot">[</span>
    <span class="fu">{</span>
      <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;school&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;description&quot;</span><span class="fu">:</span> <span class="st">&quot;school id&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;@type&quot;</span><span class="fu">:</span> <span class="st">&quot;propertyValue&quot;</span>
    <span class="fu">}</span><span class="ot">,</span>
    <span class="fu">{</span>
      <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;teacher&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;description&quot;</span><span class="fu">:</span> <span class="st">&quot;teacher id&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;@type&quot;</span><span class="fu">:</span> <span class="st">&quot;propertyValue&quot;</span>
    <span class="fu">}</span><span class="ot">,</span>
    <span class="fu">{</span>
      <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;id&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;description&quot;</span><span class="fu">:</span> <span class="st">&quot;student id&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;@type&quot;</span><span class="fu">:</span> <span class="st">&quot;propertyValue&quot;</span>
    <span class="fu">}</span><span class="ot">,</span>
    <span class="fu">{</span>
      <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;group&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;description&quot;</span><span class="fu">:</span> <span class="st">&quot;Achievement Level&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;value&quot;</span><span class="fu">:</span> <span class="st">&quot;1. High achieving,</span><span class="ch">\n</span><span class="st">2. Average achieving,</span><span class="ch">\n</span><span class="st">3. Low achieving,</span><span class="ch">\n</span><span class="st">4. Learning disabled&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;maxValue&quot;</span><span class="fu">:</span> <span class="dv">4</span><span class="fu">,</span>
      <span class="dt">&quot;minValue&quot;</span><span class="fu">:</span> <span class="dv">1</span><span class="fu">,</span>
      <span class="dt">&quot;@type&quot;</span><span class="fu">:</span> <span class="st">&quot;propertyValue&quot;</span>
    <span class="fu">}</span><span class="ot">,</span>
    <span class="fu">{</span>
      <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;treatmt&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;description&quot;</span><span class="fu">:</span> <span class="st">&quot;treatment condition&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;value&quot;</span><span class="fu">:</span> <span class="st">&quot;1. Experimental,</span><span class="ch">\n</span><span class="st">2. Control&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;maxValue&quot;</span><span class="fu">:</span> <span class="dv">2</span><span class="fu">,</span>
      <span class="dt">&quot;minValue&quot;</span><span class="fu">:</span> <span class="dv">1</span><span class="fu">,</span>
      <span class="dt">&quot;@type&quot;</span><span class="fu">:</span> <span class="st">&quot;propertyValue&quot;</span>
    <span class="fu">}</span><span class="ot">,</span>
    <span class="fu">{</span>
      <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;cch1&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;description&quot;</span><span class="fu">:</span> <span class="st">&quot;holistic, pretest&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;@type&quot;</span><span class="fu">:</span> <span class="st">&quot;propertyValue&quot;</span>
    <span class="fu">}</span><span class="ot">,</span>
    <span class="fu">{</span>
      <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;cch2&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;description&quot;</span><span class="fu">:</span> <span class="st">&quot;holistic, posttest&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;@type&quot;</span><span class="fu">:</span> <span class="st">&quot;propertyValue&quot;</span>
    <span class="fu">}</span><span class="ot">,</span>
    <span class="fu">{</span>
      <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;pre_test&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;description&quot;</span><span class="fu">:</span> <span class="st">&quot;pre_test&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;@type&quot;</span><span class="fu">:</span> <span class="st">&quot;propertyValue&quot;</span>
    <span class="fu">}</span><span class="ot">,</span>
    <span class="fu">{</span>
      <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;post_test&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;description&quot;</span><span class="fu">:</span> <span class="st">&quot;post_test&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;@type&quot;</span><span class="fu">:</span> <span class="st">&quot;propertyValue&quot;</span>
    <span class="fu">}</span><span class="ot">,</span>
    <span class="fu">{</span>
      <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;ccprod1&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;description&quot;</span><span class="fu">:</span> <span class="st">&quot;productivity, pretest&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;@type&quot;</span><span class="fu">:</span> <span class="st">&quot;propertyValue&quot;</span>
    <span class="fu">}</span><span class="ot">,</span>
    <span class="fu">{</span>
      <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;ccprod2&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;description&quot;</span><span class="fu">:</span> <span class="st">&quot;productivity, posttest&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;@type&quot;</span><span class="fu">:</span> <span class="st">&quot;propertyValue&quot;</span>
    <span class="fu">}</span><span class="ot">,</span>
    <span class="fu">{</span>
      <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;ccrdr1&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;description&quot;</span><span class="fu">:</span> <span class="st">&quot;r. sensitivity, pretest&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;@type&quot;</span><span class="fu">:</span> <span class="st">&quot;propertyValue&quot;</span>
    <span class="fu">}</span><span class="ot">,</span>
    <span class="fu">{</span>
      <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;ccrdr2&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;description&quot;</span><span class="fu">:</span> <span class="st">&quot;r. sensitivity, posttest&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;@type&quot;</span><span class="fu">:</span> <span class="st">&quot;propertyValue&quot;</span>
    <span class="fu">}</span><span class="ot">,</span>
    <span class="fu">{</span>
      <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;grade&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;description&quot;</span><span class="fu">:</span> <span class="st">&quot;grade&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;value&quot;</span><span class="fu">:</span> <span class="st">&quot;1. Fourth grade,</span><span class="ch">\n</span><span class="st">2. Fifth grade&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;maxValue&quot;</span><span class="fu">:</span> <span class="dv">2</span><span class="fu">,</span>
      <span class="dt">&quot;minValue&quot;</span><span class="fu">:</span> <span class="dv">1</span><span class="fu">,</span>
      <span class="dt">&quot;@type&quot;</span><span class="fu">:</span> <span class="st">&quot;propertyValue&quot;</span>
    <span class="fu">}</span><span class="ot">,</span>
    <span class="fu">{</span>
      <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;CSIW&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;@type&quot;</span><span class="fu">:</span> <span class="st">&quot;propertyValue&quot;</span>
    <span class="fu">}</span>
  <span class="ot">]</span>
<span class="fu">}</span><span class="er">`</span></code></pre>
</details>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="naive-model.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
